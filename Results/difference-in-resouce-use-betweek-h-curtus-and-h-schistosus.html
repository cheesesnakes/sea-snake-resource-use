<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>4 Difference in resouce use betweek H. curtus and H. schistosus? | Resouce use in two sympatric species of sea snakes in anthropogenically dominated seascape</title>
  <meta name="description" content="4 Difference in resouce use betweek H. curtus and H. schistosus? | Resouce use in two sympatric species of sea snakes in anthropogenically dominated seascape" />
  <meta name="generator" content="bookdown 0.19 and GitBook 2.6.7" />

  <meta property="og:title" content="4 Difference in resouce use betweek H. curtus and H. schistosus? | Resouce use in two sympatric species of sea snakes in anthropogenically dominated seascape" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="4 Difference in resouce use betweek H. curtus and H. schistosus? | Resouce use in two sympatric species of sea snakes in anthropogenically dominated seascape" />
  
  
  

<meta name="author" content="Shawn Dsouza, Chetan Rao, Muralidharan M., and Kartik Shanker" />


<meta name="date" content="2020-05-28" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="difference-in-diet-between-h-curtus-and-h-schsitosus.html"/>
<link rel="next" href="varition-in-fishing-intensity-along-the-sindhudurg-coast.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="difference-in-distribution-and-habitat-use-between-h-curtus-and-h-shcistosus.html"><a href="difference-in-distribution-and-habitat-use-between-h-curtus-and-h-shcistosus.html"><i class="fa fa-check"></i><b>2</b> DIfference in distribution and habitat use between <em>H. curtus</em> and <em>H. shcistosus</em></a><ul>
<li class="chapter" data-level="2.1" data-path="difference-in-distribution-and-habitat-use-between-h-curtus-and-h-shcistosus.html"><a href="difference-in-distribution-and-habitat-use-between-h-curtus-and-h-shcistosus.html#mapping-sea-snake-distribution-with-fisheries-survey-data"><i class="fa fa-check"></i><b>2.1</b> Mapping sea snake distribution with fisheries survey data</a></li>
<li class="chapter" data-level="2.2" data-path="difference-in-distribution-and-habitat-use-between-h-curtus-and-h-shcistosus.html"><a href="difference-in-distribution-and-habitat-use-between-h-curtus-and-h-shcistosus.html#summarising-depth-use-by-species"><i class="fa fa-check"></i><b>2.2</b> Summarising depth use by species</a></li>
<li class="chapter" data-level="2.3" data-path="difference-in-distribution-and-habitat-use-between-h-curtus-and-h-shcistosus.html"><a href="difference-in-distribution-and-habitat-use-between-h-curtus-and-h-shcistosus.html#spatial-segregation-by-species"><i class="fa fa-check"></i><b>2.3</b> Spatial segregation by species</a></li>
<li class="chapter" data-level="2.4" data-path="difference-in-distribution-and-habitat-use-between-h-curtus-and-h-shcistosus.html"><a href="difference-in-distribution-and-habitat-use-between-h-curtus-and-h-shcistosus.html#modelling-depth-use-by-species"><i class="fa fa-check"></i><b>2.4</b> Modelling depth use by species</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="difference-in-diet-between-h-curtus-and-h-schsitosus.html"><a href="difference-in-diet-between-h-curtus-and-h-schsitosus.html"><i class="fa fa-check"></i><b>3</b> DIfference in diet between <em>H. curtus</em> and <em>H. schsitosus</em></a><ul>
<li class="chapter" data-level="3.1" data-path="difference-in-diet-between-h-curtus-and-h-schsitosus.html"><a href="difference-in-diet-between-h-curtus-and-h-schsitosus.html#no.-of-samples-collected-by-sea-snake-species"><i class="fa fa-check"></i><b>3.1</b> No.Â of samples collected by sea snake species</a></li>
<li class="chapter" data-level="3.2" data-path="difference-in-diet-between-h-curtus-and-h-schsitosus.html"><a href="difference-in-diet-between-h-curtus-and-h-schsitosus.html#proportion-of-unidentified-specimens"><i class="fa fa-check"></i><b>3.2</b> Proportion of unidentified specimens</a></li>
<li class="chapter" data-level="3.3" data-path="difference-in-diet-between-h-curtus-and-h-schsitosus.html"><a href="difference-in-diet-between-h-curtus-and-h-schsitosus.html#diverisity-of-prey-families-found-in-gut-content"><i class="fa fa-check"></i><b>3.3</b> Diverisity of prey families found in gut content</a></li>
<li class="chapter" data-level="3.4" data-path="difference-in-diet-between-h-curtus-and-h-schsitosus.html"><a href="difference-in-diet-between-h-curtus-and-h-schsitosus.html#list-of-sea-snake-prey-species"><i class="fa fa-check"></i><b>3.4</b> List of sea snake prey species</a></li>
<li class="chapter" data-level="3.5" data-path="difference-in-diet-between-h-curtus-and-h-schsitosus.html"><a href="difference-in-diet-between-h-curtus-and-h-schsitosus.html#relative-abundance-of-prey-families-in-sea-snake-gut-content"><i class="fa fa-check"></i><b>3.5</b> Relative abundance of prey families in sea snake gut content</a></li>
<li class="chapter" data-level="3.6" data-path="difference-in-diet-between-h-curtus-and-h-schsitosus.html"><a href="difference-in-diet-between-h-curtus-and-h-schsitosus.html#diverisity-of-prey-families-found-in-gut-content-1"><i class="fa fa-check"></i><b>3.6</b> Diverisity of prey families found in gut content</a></li>
<li class="chapter" data-level="3.7" data-path="difference-in-diet-between-h-curtus-and-h-schsitosus.html"><a href="difference-in-diet-between-h-curtus-and-h-schsitosus.html#overlap-in-prey-of-h.-curtus-and-h.-schsitosus"><i class="fa fa-check"></i><b>3.7</b> Overlap in prey of <em>H. curtus</em> and <em>H. schsitosus</em></a></li>
<li class="chapter" data-level="3.8" data-path="difference-in-diet-between-h-curtus-and-h-schsitosus.html"><a href="difference-in-diet-between-h-curtus-and-h-schsitosus.html#prey-preference"><i class="fa fa-check"></i><b>3.8</b> Prey preference</a></li>
<li class="chapter" data-level="3.9" data-path="difference-in-diet-between-h-curtus-and-h-schsitosus.html"><a href="difference-in-diet-between-h-curtus-and-h-schsitosus.html#selectivity-of-prey-sizes"><i class="fa fa-check"></i><b>3.9</b> Selectivity of prey sizes</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="difference-in-resouce-use-betweek-h-curtus-and-h-schistosus.html"><a href="difference-in-resouce-use-betweek-h-curtus-and-h-schistosus.html"><i class="fa fa-check"></i><b>4</b> Difference in resouce use betweek <em>H. curtus</em> and <em>H. schistosus</em>?</a><ul>
<li class="chapter" data-level="4.1" data-path="difference-in-resouce-use-betweek-h-curtus-and-h-schistosus.html"><a href="difference-in-resouce-use-betweek-h-curtus-and-h-schistosus.html#number-of-samples-analysed"><i class="fa fa-check"></i><b>4.1</b> Number of samples analysed</a></li>
<li class="chapter" data-level="4.2" data-path="difference-in-resouce-use-betweek-h-curtus-and-h-schistosus.html"><a href="difference-in-resouce-use-betweek-h-curtus-and-h-schistosus.html#summary-statistics-on-carbon-and-nitrogen-stable-isotopes"><i class="fa fa-check"></i><b>4.2</b> Summary statistics on Carbon and Nitrogen stable isotopes</a></li>
<li class="chapter" data-level="4.3" data-path="difference-in-resouce-use-betweek-h-curtus-and-h-schistosus.html"><a href="difference-in-resouce-use-betweek-h-curtus-and-h-schistosus.html#difference-in-niche-width-between-sea-snakes"><i class="fa fa-check"></i><b>4.3</b> Difference in niche width between sea snakes</a><ul>
<li class="chapter" data-level="4.3.1" data-path="difference-in-resouce-use-betweek-h-curtus-and-h-schistosus.html"><a href="difference-in-resouce-use-betweek-h-curtus-and-h-schistosus.html#maximum-likelihood-estimate-of-sea"><i class="fa fa-check"></i><b>4.3.1</b> Maximum likelihood estimate of SEA</a></li>
<li class="chapter" data-level="4.3.2" data-path="difference-in-resouce-use-betweek-h-curtus-and-h-schistosus.html"><a href="difference-in-resouce-use-betweek-h-curtus-and-h-schistosus.html#bayesian-estimate-of-sea"><i class="fa fa-check"></i><b>4.3.2</b> Bayesian estimate of SEA</a></li>
<li class="chapter" data-level="4.3.3" data-path="difference-in-resouce-use-betweek-h-curtus-and-h-schistosus.html"><a href="difference-in-resouce-use-betweek-h-curtus-and-h-schistosus.html#testing-difference-in-species-niche-area-by-tissue-type"><i class="fa fa-check"></i><b>4.3.3</b> Testing difference in species niche area by tissue type</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="difference-in-resouce-use-betweek-h-curtus-and-h-schistosus.html"><a href="difference-in-resouce-use-betweek-h-curtus-and-h-schistosus.html#visualising-posterior-ellipses-to-compare-species-isotopic-niche"><i class="fa fa-check"></i><b>4.4</b> Visualising posterior ellipses to compare species isotopic niche</a></li>
<li class="chapter" data-level="4.5" data-path="difference-in-resouce-use-betweek-h-curtus-and-h-schistosus.html"><a href="difference-in-resouce-use-betweek-h-curtus-and-h-schistosus.html#relative-overlap-in-bayesian-standard-ellipses"><i class="fa fa-check"></i><b>4.5</b> Relative overlap in bayesian standard ellipses</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="varition-in-fishing-intensity-along-the-sindhudurg-coast.html"><a href="varition-in-fishing-intensity-along-the-sindhudurg-coast.html"><i class="fa fa-check"></i><b>5</b> Varition in fishing intensity along the sindhudurg coast</a><ul>
<li class="chapter" data-level="5.1" data-path="varition-in-fishing-intensity-along-the-sindhudurg-coast.html"><a href="varition-in-fishing-intensity-along-the-sindhudurg-coast.html#calculating-effort-with-depth"><i class="fa fa-check"></i><b>5.1</b> Calculating effort with depth</a></li>
<li class="chapter" data-level="5.2" data-path="varition-in-fishing-intensity-along-the-sindhudurg-coast.html"><a href="varition-in-fishing-intensity-along-the-sindhudurg-coast.html#mapping-fishing-intensity"><i class="fa fa-check"></i><b>5.2</b> Mapping fishing intensity</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="does-fishing-intensity-affect-the-distribution-of-h-curtus-and-h-schistosus.html"><a href="does-fishing-intensity-affect-the-distribution-of-h-curtus-and-h-schistosus.html"><i class="fa fa-check"></i><b>6</b> Does fishing intensity affect the distribution of <em>H. curtus</em> and <em>H. schistosus</em>?</a><ul>
<li class="chapter" data-level="6.1" data-path="does-fishing-intensity-affect-the-distribution-of-h-curtus-and-h-schistosus.html"><a href="does-fishing-intensity-affect-the-distribution-of-h-curtus-and-h-schistosus.html#spatial-overlap-between-fisheries-and-sea-snakes"><i class="fa fa-check"></i><b>6.1</b> Spatial overlap between fisheries and sea snakes</a></li>
<li class="chapter" data-level="6.2" data-path="does-fishing-intensity-affect-the-distribution-of-h-curtus-and-h-schistosus.html"><a href="does-fishing-intensity-affect-the-distribution-of-h-curtus-and-h-schistosus.html#variation-in-relative-proportion-of-hc-with-fishing-intensity"><i class="fa fa-check"></i><b>6.2</b> Variation in relative proportion of HC with fishing intensity</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="overlap-between-fisheries-catch-and-sea-snake-diet.html"><a href="overlap-between-fisheries-catch-and-sea-snake-diet.html"><i class="fa fa-check"></i><b>7</b> Overlap between fisheries catch and sea snake diet</a><ul>
<li class="chapter" data-level="7.1" data-path="overlap-between-fisheries-catch-and-sea-snake-diet.html"><a href="overlap-between-fisheries-catch-and-sea-snake-diet.html#sampling-adequacy"><i class="fa fa-check"></i><b>7.1</b> Sampling Adequacy</a></li>
<li class="chapter" data-level="7.2" data-path="overlap-between-fisheries-catch-and-sea-snake-diet.html"><a href="overlap-between-fisheries-catch-and-sea-snake-diet.html#catch-weight"><i class="fa fa-check"></i><b>7.2</b> Catch weight</a></li>
<li class="chapter" data-level="7.3" data-path="overlap-between-fisheries-catch-and-sea-snake-diet.html"><a href="overlap-between-fisheries-catch-and-sea-snake-diet.html#diverisity-of-prey-families-found-in-fisheries-catch"><i class="fa fa-check"></i><b>7.3</b> Diverisity of prey families found in fisheries catch</a></li>
<li class="chapter" data-level="7.4" data-path="overlap-between-fisheries-catch-and-sea-snake-diet.html"><a href="overlap-between-fisheries-catch-and-sea-snake-diet.html#no.-of-sea-snake-prey-families-found-in-fish-catch-and-overlap"><i class="fa fa-check"></i><b>7.4</b> No.Â of Sea snake prey families found in fish catch and overlap</a></li>
<li class="chapter" data-level="7.5" data-path="overlap-between-fisheries-catch-and-sea-snake-diet.html"><a href="overlap-between-fisheries-catch-and-sea-snake-diet.html#sea-snake-prey-species-in-fisheries-catch"><i class="fa fa-check"></i><b>7.5</b> Sea snake prey species in fisheries catch</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="does-isotopic-niche-of-sea-snakes-change-with-local-fishing-intensity.html"><a href="does-isotopic-niche-of-sea-snakes-change-with-local-fishing-intensity.html"><i class="fa fa-check"></i><b>8</b> Does isotopic niche of sea snakes change with local fishing intensity?</a><ul>
<li class="chapter" data-level="8.1" data-path="does-isotopic-niche-of-sea-snakes-change-with-local-fishing-intensity.html"><a href="does-isotopic-niche-of-sea-snakes-change-with-local-fishing-intensity.html#sample-size"><i class="fa fa-check"></i><b>8.1</b> Sample size</a></li>
<li class="chapter" data-level="8.2" data-path="does-isotopic-niche-of-sea-snakes-change-with-local-fishing-intensity.html"><a href="does-isotopic-niche-of-sea-snakes-change-with-local-fishing-intensity.html#variation-carbon-isotope-ratio-with-fishing-intensity"><i class="fa fa-check"></i><b>8.2</b> Variation Carbon isotope ratio with fishing intensity</a></li>
<li class="chapter" data-level="8.3" data-path="does-isotopic-niche-of-sea-snakes-change-with-local-fishing-intensity.html"><a href="does-isotopic-niche-of-sea-snakes-change-with-local-fishing-intensity.html#modeling-isotope-ratios-with-fishing-intensity"><i class="fa fa-check"></i><b>8.3</b> Modeling isotope ratios with fishing intensity</a><ul>
<li class="chapter" data-level="8.3.1" data-path="does-isotopic-niche-of-sea-snakes-change-with-local-fishing-intensity.html"><a href="does-isotopic-niche-of-sea-snakes-change-with-local-fishing-intensity.html#continous-model"><i class="fa fa-check"></i><b>8.3.1</b> Continous model</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="does-isotopic-niche-of-sea-snakes-change-with-local-fishing-intensity.html"><a href="does-isotopic-niche-of-sea-snakes-change-with-local-fishing-intensity.html#difference-in-niche-width-between-sea-snakes-1"><i class="fa fa-check"></i><b>8.4</b> Difference in niche width between sea snakes</a><ul>
<li class="chapter" data-level="8.4.1" data-path="does-isotopic-niche-of-sea-snakes-change-with-local-fishing-intensity.html"><a href="does-isotopic-niche-of-sea-snakes-change-with-local-fishing-intensity.html#maximum-likelihood-estimate-of-sea-1"><i class="fa fa-check"></i><b>8.4.1</b> Maximum likelihood estimate of SEA</a></li>
<li class="chapter" data-level="8.4.2" data-path="does-isotopic-niche-of-sea-snakes-change-with-local-fishing-intensity.html"><a href="does-isotopic-niche-of-sea-snakes-change-with-local-fishing-intensity.html#bayesian-estimate-of-sea-1"><i class="fa fa-check"></i><b>8.4.2</b> Bayesian estimate of SEA</a></li>
<li class="chapter" data-level="8.4.3" data-path="does-isotopic-niche-of-sea-snakes-change-with-local-fishing-intensity.html"><a href="does-isotopic-niche-of-sea-snakes-change-with-local-fishing-intensity.html#testing-difference-in-species-niche-area-by-tissue-type-1"><i class="fa fa-check"></i><b>8.4.3</b> Testing difference in species niche area by tissue type</a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Resouce use in two sympatric species of sea snakes in anthropogenically dominated seascape</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="difference-in-resouce-use-betweek-h.-curtus-and-h.-schistosus" class="section level1">
<h1><span class="header-section-number">4</span> Difference in resouce use betweek <em>H. curtus</em> and <em>H. schistosus</em>?</h1>
<p>Carbon and Nitrogen isotope ratios were compared accorss species. Plasma and scale samples were used to compare short term and long term resource use respectively. Multiples metrics including niche width (SEA), variance (range), overlap (%) were used.</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb98-1" title="1"><span class="co">#Stable isotope data</span></a>
<a class="sourceLine" id="cb98-2" title="2">sia =<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;../Data/Stable Isotope Data_CEAS_241119.csv&quot;</span>)</a></code></pre></div>
<pre><code>## Error in file(file, &quot;rt&quot;): cannot open the connection</code></pre>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb100-1" title="1"><span class="co">#joining sia data to snake data</span></a>
<a class="sourceLine" id="cb100-2" title="2"></a>
<a class="sourceLine" id="cb100-3" title="3">sia_snakes =<span class="st"> </span>sia<span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb100-4" title="4"><span class="st">  </span><span class="kw">filter</span>(Tissue.type <span class="op">!=</span><span class="st"> &quot;Gut Content&quot;</span>)<span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb100-5" title="5"><span class="st">  </span><span class="kw">left_join</span>(snakes, <span class="st">&#39;Field.Code&#39;</span>)<span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb100-6" title="6"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Lab =</span> <span class="st">&quot;CEAS&quot;</span>)<span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb100-7" title="7"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">rename</span>(<span class="dt">Delta.Carbon =</span> d13C..vpdb. , <span class="dt">Delta.Nitrogen =</span> d15N..N2.air.)<span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb100-8" title="8"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(Date, Field.Code, Species, Snout.to.Vent..cm., Sex, Gravid, Class,</a>
<a class="sourceLine" id="cb100-9" title="9">                Gear.Type, Fishing.Location, Depth.Caught..m.,</a>
<a class="sourceLine" id="cb100-10" title="10">                Plasma.Color, Delta.Carbon, Delta.Nitrogen, Lab, </a>
<a class="sourceLine" id="cb100-11" title="11">                Tissue.type, Month, Year)</a></code></pre></div>
<pre><code>## Error in eval(lhs, parent, parent): object &#39;sia&#39; not found</code></pre>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb102-1" title="1"><span class="co">#labels</span></a>
<a class="sourceLine" id="cb102-2" title="2"></a>
<a class="sourceLine" id="cb102-3" title="3">D.C =<span class="kw">expression</span>({delta}<span class="op">^</span><span class="dv">13</span><span class="op">*</span>C<span class="op">~</span><span class="st">&#39;\u2030&#39;</span>) </a>
<a class="sourceLine" id="cb102-4" title="4"></a>
<a class="sourceLine" id="cb102-5" title="5">D.N =<span class="kw">expression</span>({delta}<span class="op">^</span><span class="dv">15</span><span class="op">*</span>N<span class="op">~</span><span class="st">&#39;\u2030&#39;</span>)</a></code></pre></div>
<div id="number-of-samples-analysed" class="section level2">
<h2><span class="header-section-number">4.1</span> Number of samples analysed</h2>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb103-1" title="1">sia_snakes<span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb103-2" title="2"><span class="st">  </span><span class="kw">filter</span>(Tissue.type <span class="op">==</span><span class="st"> &quot;Plasma&quot;</span> <span class="op">|</span><span class="st"> </span>Tissue.type <span class="op">==</span><span class="st"> &quot;Scales&quot;</span>)<span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb103-3" title="3"><span class="st">  </span><span class="kw">filter</span>(Species <span class="op">==</span><span class="st"> &quot;Hydrophis curtus&quot;</span> <span class="op">|</span><span class="st"> </span>Species <span class="op">==</span><span class="st"> &quot;Hydrophis schistosus&quot;</span>)<span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb103-4" title="4"><span class="st">  </span><span class="kw">group_by</span>(Species, Tissue.type)<span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb103-5" title="5"><span class="st">  </span><span class="kw">count</span>()<span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb103-6" title="6"><span class="st">  </span><span class="kw">spread</span>(Tissue.type, n)</a></code></pre></div>
<pre><code>## Error in eval(lhs, parent, parent): object &#39;sia_snakes&#39; not found</code></pre>
</div>
<div id="summary-statistics-on-carbon-and-nitrogen-stable-isotopes" class="section level2">
<h2><span class="header-section-number">4.2</span> Summary statistics on Carbon and Nitrogen stable isotopes</h2>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb105-1" title="1">sia_snakes<span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb105-2" title="2"><span class="st">  </span><span class="kw">filter</span>(Tissue.type <span class="op">==</span><span class="st"> &quot;Plasma&quot;</span> <span class="op">|</span><span class="st"> </span>Tissue.type <span class="op">==</span><span class="st"> &quot;Scales&quot;</span>)<span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb105-3" title="3"><span class="st">  </span><span class="kw">filter</span>(Species <span class="op">==</span><span class="st"> &quot;Hydrophis curtus&quot;</span> <span class="op">|</span><span class="st"> </span>Species <span class="op">==</span><span class="st"> &quot;Hydrophis schistosus&quot;</span>)<span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb105-4" title="4"><span class="st">  </span><span class="kw">gather</span>(<span class="kw">c</span>(<span class="st">&quot;Delta.Carbon&quot;</span>, <span class="st">&quot;Delta.Nitrogen&quot;</span>), <span class="dt">key =</span> <span class="st">&quot;Isotope&quot;</span>, <span class="dt">value =</span> <span class="st">&quot;value&quot;</span>)<span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb105-5" title="5"><span class="st">  </span><span class="kw">group_by</span>(Species, Tissue.type, Isotope)<span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb105-6" title="6"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">Mean =</span> <span class="kw">round</span>(<span class="kw">mean</span>(value, <span class="dt">na.rm =</span> T), <span class="dv">2</span>),</a>
<a class="sourceLine" id="cb105-7" title="7">            <span class="dt">sd =</span> <span class="kw">round</span>(<span class="kw">sd</span>(value, <span class="dt">na.rm =</span> T), <span class="dv">2</span>),</a>
<a class="sourceLine" id="cb105-8" title="8">            <span class="dt">n =</span> <span class="kw">sum</span>(<span class="op">!</span><span class="kw">is.na</span>(value)))<span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb105-9" title="9"><span class="st">  </span><span class="kw">unite</span>(<span class="st">&quot;Mean.sd&quot;</span>, Mean<span class="op">:</span>sd, <span class="dt">sep =</span> <span class="st">&quot;Â±&quot;</span>)<span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb105-10" title="10"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>n)<span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb105-11" title="11"><span class="st">  </span><span class="kw">spread</span>(Isotope, Mean.sd)</a></code></pre></div>
<pre><code>## Error in eval(lhs, parent, parent): object &#39;sia_snakes&#39; not found</code></pre>
</div>
<div id="difference-in-niche-width-between-sea-snakes" class="section level2">
<h2><span class="header-section-number">4.3</span> Difference in niche width between sea snakes</h2>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb107-1" title="1"><span class="kw">library</span>(SIBER)</a>
<a class="sourceLine" id="cb107-2" title="2"></a>
<a class="sourceLine" id="cb107-3" title="3"><span class="co">#Creating siber data</span></a>
<a class="sourceLine" id="cb107-4" title="4">siber_snakes =<span class="st"> </span>sia_snakes<span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb107-5" title="5"><span class="st">  </span><span class="kw">filter</span>()<span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb107-6" title="6"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(Delta.Carbon, Delta.Nitrogen, Tissue.type, Species)<span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb107-7" title="7"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">rename</span>(<span class="dt">iso1 =</span> Delta.Carbon,</a>
<a class="sourceLine" id="cb107-8" title="8">         <span class="dt">iso2 =</span> Delta.Nitrogen,</a>
<a class="sourceLine" id="cb107-9" title="9">         <span class="dt">group =</span> Tissue.type,</a>
<a class="sourceLine" id="cb107-10" title="10">         <span class="dt">community =</span> Species)<span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb107-11" title="11"><span class="st">  </span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">is.na</span>(group),</a>
<a class="sourceLine" id="cb107-12" title="12">         <span class="op">!</span><span class="kw">is.na</span>(iso1),</a>
<a class="sourceLine" id="cb107-13" title="13">         <span class="op">!</span><span class="kw">is.na</span>(iso2),</a>
<a class="sourceLine" id="cb107-14" title="14">         community <span class="op">==</span><span class="st"> &quot;Hydrophis schistosus&quot;</span> <span class="op">|</span><span class="st"> </span>community <span class="op">==</span><span class="st"> &quot;Hydrophis curtus&quot;</span>)<span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb107-15" title="15"><span class="st">  </span><span class="kw">droplevels</span>()</a></code></pre></div>
<pre><code>## Error in eval(lhs, parent, parent): object &#39;sia_snakes&#39; not found</code></pre>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb109-1" title="1">siber.snakes =<span class="st"> </span><span class="kw">createSiberObject</span>(siber_snakes)</a></code></pre></div>
<pre><code>## Error in createSiberObject(siber_snakes): object &#39;siber_snakes&#39; not found</code></pre>
<div id="maximum-likelihood-estimate-of-sea" class="section level3">
<h3><span class="header-section-number">4.3.1</span> Maximum likelihood estimate of SEA</h3>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb111-1" title="1">SEA.ML_snakes &lt;-<span class="st"> </span><span class="kw">groupMetricsML</span>(siber.snakes) <span class="co">#maximum likelihood estimates</span></a></code></pre></div>
<pre><code>## Error in groupMetricsML(siber.snakes): object &#39;siber.snakes&#39; not found</code></pre>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb113-1" title="1"><span class="kw">data.frame</span>(<span class="kw">t</span>(SEA.ML_snakes))</a></code></pre></div>
<pre><code>## Error in t(SEA.ML_snakes): object &#39;SEA.ML_snakes&#39; not found</code></pre>
<p>As maximum likelihood can only porivde point estimates of SEA, a bayesian model was used to provide more robust comparison of niche width.</p>
</div>
<div id="bayesian-estimate-of-sea" class="section level3">
<h3><span class="header-section-number">4.3.2</span> Bayesian estimate of SEA</h3>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb115-1" title="1"><span class="co"># options for running jags</span></a>
<a class="sourceLine" id="cb115-2" title="2">parms &lt;-<span class="st"> </span><span class="kw">list</span>()</a>
<a class="sourceLine" id="cb115-3" title="3">parms<span class="op">$</span>n.iter &lt;-<span class="st"> </span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span><span class="dv">10</span><span class="op">^</span><span class="dv">4</span>   <span class="co"># number of iterations to run the model for</span></a>
<a class="sourceLine" id="cb115-4" title="4">parms<span class="op">$</span>n.burnin &lt;-<span class="st"> </span><span class="dv">1</span> <span class="op">*</span><span class="st"> </span><span class="dv">10</span><span class="op">^</span><span class="dv">3</span> <span class="co"># discard the first set of values</span></a>
<a class="sourceLine" id="cb115-5" title="5">parms<span class="op">$</span>n.thin &lt;-<span class="st"> </span><span class="dv">10</span>     <span class="co"># thin the posterior by this many</span></a>
<a class="sourceLine" id="cb115-6" title="6">parms<span class="op">$</span>n.chains &lt;-<span class="st"> </span><span class="dv">2</span>        <span class="co"># run this many chains</span></a>
<a class="sourceLine" id="cb115-7" title="7"></a>
<a class="sourceLine" id="cb115-8" title="8"><span class="co"># define the priors</span></a>
<a class="sourceLine" id="cb115-9" title="9">priors &lt;-<span class="st"> </span><span class="kw">list</span>()</a>
<a class="sourceLine" id="cb115-10" title="10">priors<span class="op">$</span>R &lt;-<span class="st"> </span><span class="dv">1</span> <span class="op">*</span><span class="st"> </span><span class="kw">diag</span>(<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb115-11" title="11">priors<span class="op">$</span>k &lt;-<span class="st"> </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb115-12" title="12">priors<span class="op">$</span>tau.mu &lt;-<span class="st"> </span><span class="fl">1.0E-3</span></a>
<a class="sourceLine" id="cb115-13" title="13"></a>
<a class="sourceLine" id="cb115-14" title="14">snakes.post &lt;-<span class="st"> </span><span class="kw">siberMVN</span>(siber.snakes, parms, priors)<span class="co">#fitting multivariate normal model and getting                                                          posteriors</span></a></code></pre></div>
<pre><code>## Error in siberMVN(siber.snakes, parms, priors): object &#39;siber.snakes&#39; not found</code></pre>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb117-1" title="1">SEA.B_snakes &lt;-<span class="st"> </span><span class="kw">siberEllipses</span>(snakes.post)<span class="co">#estimating standard ellipse area from posteriors</span></a></code></pre></div>
<pre><code>## Error in nrow(corrected.posteriors[[1]]): object &#39;snakes.post&#39; not found</code></pre>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb119-1" title="1">means.B_snakes &lt;-<span class="st"> </span><span class="kw">extractPosteriorMeans</span>(siber.snakes, snakes.post)<span class="co">#mean isotope values</span></a></code></pre></div>
<pre><code>## Error in paste(siber$original.data[, &quot;community&quot;], siber$original.data[, : object &#39;siber.snakes&#39; not found</code></pre>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb121-1" title="1">ccc &lt;-<span class="st"> </span><span class="kw">names</span>(snakes.post)</a></code></pre></div>
<pre><code>## Error in eval(expr, envir, enclos): object &#39;snakes.post&#39; not found</code></pre>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb123-1" title="1"><span class="kw">colnames</span>(SEA.B_snakes) &lt;-<span class="st"> </span>ccc</a></code></pre></div>
<pre><code>## Error in eval(expr, envir, enclos): object &#39;ccc&#39; not found</code></pre>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb125-1" title="1">SEA.B_snakesdf =<span class="st"> </span><span class="kw">data.frame</span>(SEA.B_snakes, <span class="dt">check.names =</span> F)<span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb125-2" title="2"><span class="st">  </span><span class="kw">rowid_to_column</span>(<span class="dt">var =</span> <span class="st">&quot;run&quot;</span>)<span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb125-3" title="3"><span class="st">  </span><span class="kw">gather</span>(Species.Tissue, SEA.B, <span class="op">-</span>run)<span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb125-4" title="4"><span class="st">  </span><span class="kw">separate</span>(Species.Tissue, <span class="kw">c</span>(<span class="st">&quot;Species&quot;</span>,<span class="st">&quot;Tissue&quot;</span>), <span class="dt">sep =</span> <span class="st">&quot;([</span><span class="ch">\\</span><span class="st">.</span><span class="ch">\\</span><span class="st">?</span><span class="ch">\\</span><span class="st">:])&quot;</span>)</a></code></pre></div>
<pre><code>## Error in data.frame(SEA.B_snakes, check.names = F): object &#39;SEA.B_snakes&#39; not found</code></pre>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb127-1" title="1"><span class="co">#Summarising SEA estimates</span></a>
<a class="sourceLine" id="cb127-2" title="2"></a>
<a class="sourceLine" id="cb127-3" title="3">SEA.B_snakesdf<span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb127-4" title="4"><span class="st">  </span><span class="kw">group_by</span>(Species, Tissue)<span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb127-5" title="5"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">SEA.mean =</span> <span class="kw">mean</span>(SEA.B),</a>
<a class="sourceLine" id="cb127-6" title="6">            <span class="dt">SEA.sd =</span> <span class="kw">sd</span>(SEA.B),</a>
<a class="sourceLine" id="cb127-7" title="7">            <span class="dt">SEA.se =</span> <span class="kw">sd</span>(SEA.B)<span class="op">/</span><span class="kw">sqrt</span>(<span class="kw">n</span>()))</a></code></pre></div>
<pre><code>## Error in eval(lhs, parent, parent): object &#39;SEA.B_snakesdf&#39; not found</code></pre>
</div>
<div id="testing-difference-in-species-niche-area-by-tissue-type" class="section level3">
<h3><span class="header-section-number">4.3.3</span> Testing difference in species niche area by tissue type</h3>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb129-1" title="1">SEA.B_snakesdf<span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb129-2" title="2"><span class="st">  </span><span class="kw">spread</span>(<span class="dt">key =</span> Species, <span class="dt">value =</span> SEA.B)<span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb129-3" title="3"><span class="st">  </span><span class="kw">group_by</span>(Tissue)<span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb129-4" title="4"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">p =</span> <span class="kw">sum</span>(<span class="st">`</span><span class="dt">Hydrophis schistosus</span><span class="st">`</span> <span class="op">&gt;</span><span class="st"> `</span><span class="dt">Hydrophis curtus</span><span class="st">`</span>)<span class="op">/</span><span class="kw">n</span>())</a></code></pre></div>
<pre><code>## Error in eval(lhs, parent, parent): object &#39;SEA.B_snakesdf&#39; not found</code></pre>
<p>Hyp: <em>H. schistosus</em> SEA is larger than <em>H. curtus</em></p>
<p>While niche width is slightly larger in <em>H. schistosus</em>, it is not significantly different. The posterior distribution of SEA^<sub>b</sub> has right skewed long tail (masked by the limits of the graph for visual clarity) possibly due to the low sample size. Niche width doesnât seem to change accross different tissue types either, indicating stability over variying periods of assimilation.</p>
</div>
</div>
<div id="visualising-posterior-ellipses-to-compare-species-isotopic-niche" class="section level2">
<h2><span class="header-section-number">4.4</span> Visualising posterior ellipses to compare species isotopic niche</h2>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb131-1" title="1"><span class="co"># how many of the posterior draws do you want?</span></a>
<a class="sourceLine" id="cb131-2" title="2">n.posts &lt;-<span class="st"> </span><span class="dv">10</span></a>
<a class="sourceLine" id="cb131-3" title="3"></a>
<a class="sourceLine" id="cb131-4" title="4"><span class="co"># decide how big an ellipse you want to draw</span></a>
<a class="sourceLine" id="cb131-5" title="5">p.ell &lt;-<span class="st"> </span><span class="kw">pchisq</span>(<span class="dv">1</span>,<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb131-6" title="6"></a>
<a class="sourceLine" id="cb131-7" title="7"><span class="kw">set.seed</span>(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb131-8" title="8"></a>
<a class="sourceLine" id="cb131-9" title="9"><span class="co"># a list to store the results</span></a>
<a class="sourceLine" id="cb131-10" title="10">snake_ellipses &lt;-<span class="st"> </span><span class="kw">list</span>()</a>
<a class="sourceLine" id="cb131-11" title="11"></a>
<a class="sourceLine" id="cb131-12" title="12"><span class="co"># loop over groups</span></a>
<a class="sourceLine" id="cb131-13" title="13"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(snakes.post)<span class="co">#sgenerating list with length groups*communities</span></a>
<a class="sourceLine" id="cb131-14" title="14">){</a>
<a class="sourceLine" id="cb131-15" title="15">  </a>
<a class="sourceLine" id="cb131-16" title="16">  <span class="co"># a dummy variable to build in the loop</span></a>
<a class="sourceLine" id="cb131-17" title="17">  ell &lt;-<span class="st"> </span><span class="ot">NULL</span></a>
<a class="sourceLine" id="cb131-18" title="18">  post.id &lt;-<span class="st"> </span><span class="ot">NULL</span></a>
<a class="sourceLine" id="cb131-19" title="19">  </a>
<a class="sourceLine" id="cb131-20" title="20">  <span class="cf">for</span> ( j <span class="cf">in</span> <span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">4000</span>, n.posts)){<span class="co">#randomlu extracting parameters for n samples from posterior distribution</span></a>
<a class="sourceLine" id="cb131-21" title="21">    </a>
<a class="sourceLine" id="cb131-22" title="22">    <span class="co"># covariance matrix</span></a>
<a class="sourceLine" id="cb131-23" title="23">    Sigma  &lt;-<span class="st"> </span><span class="kw">matrix</span>(snakes.post[[i]][j,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>], <span class="dv">2</span>, <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb131-24" title="24">    </a>
<a class="sourceLine" id="cb131-25" title="25">    <span class="co"># mean</span></a>
<a class="sourceLine" id="cb131-26" title="26">    mu     &lt;-<span class="st"> </span>snakes.post[[i]][j,<span class="dv">5</span><span class="op">:</span><span class="dv">6</span>]</a>
<a class="sourceLine" id="cb131-27" title="27">    </a>
<a class="sourceLine" id="cb131-28" title="28">    <span class="co"># ellipse points</span></a>
<a class="sourceLine" id="cb131-29" title="29">    </a>
<a class="sourceLine" id="cb131-30" title="30">    out &lt;-<span class="st"> </span>ellipse<span class="op">::</span><span class="kw">ellipse</span>(Sigma, <span class="dt">centre =</span> mu , <span class="dt">level =</span> p.ell)</a>
<a class="sourceLine" id="cb131-31" title="31">    </a>
<a class="sourceLine" id="cb131-32" title="32">    </a>
<a class="sourceLine" id="cb131-33" title="33">    ell &lt;-<span class="st"> </span><span class="kw">rbind</span>(ell, out) <span class="co">#ellipse points from current loop</span></a>
<a class="sourceLine" id="cb131-34" title="34">    post.id &lt;-<span class="st"> </span><span class="kw">c</span>(post.id, <span class="kw">rep</span>(j, <span class="kw">nrow</span>(out))) <span class="co">#adding loop number (rep)</span></a>
<a class="sourceLine" id="cb131-35" title="35">    </a>
<a class="sourceLine" id="cb131-36" title="36">  }</a>
<a class="sourceLine" id="cb131-37" title="37">  ell &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(ell) <span class="co"># data frame of ellipse points from all draws</span></a>
<a class="sourceLine" id="cb131-38" title="38">  ell<span class="op">$</span>rep &lt;-<span class="st"> </span>post.id <span class="co">#adding draw id</span></a>
<a class="sourceLine" id="cb131-39" title="39">  snake_ellipses[[i]] &lt;-<span class="st"> </span>ell <span class="co">#creading list of draws from each community.group</span></a>
<a class="sourceLine" id="cb131-40" title="40">}</a></code></pre></div>
<pre><code>## Error in eval(expr, envir, enclos): object &#39;snakes.post&#39; not found</code></pre>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb133-1" title="1">snake.ellipses &lt;-<span class="st"> </span><span class="kw">bind_rows</span>(snake_ellipses, <span class="dt">.id =</span> <span class="st">&quot;id&quot;</span>)<span class="co">#creating a data frame of post ellipse draws</span></a>
<a class="sourceLine" id="cb133-2" title="2"></a>
<a class="sourceLine" id="cb133-3" title="3"></a>
<a class="sourceLine" id="cb133-4" title="4"><span class="co"># now we need the group and community names</span></a>
<a class="sourceLine" id="cb133-5" title="5"></a>
<a class="sourceLine" id="cb133-6" title="6"><span class="co"># extract them from the ellipses.posterior list</span></a>
<a class="sourceLine" id="cb133-7" title="7">group_comm_names &lt;-<span class="st"> </span><span class="kw">names</span>(snakes.post)[<span class="kw">as.numeric</span>(snake.ellipses<span class="op">$</span>id)]<span class="co">#extractin communit.group from posteriors</span></a></code></pre></div>
<pre><code>## Error in eval(expr, envir, enclos): object &#39;snakes.post&#39; not found</code></pre>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb135-1" title="1"><span class="co"># split them and conver to a matrix, NB byrow = T</span></a>
<a class="sourceLine" id="cb135-2" title="2">split_group_comm &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">unlist</span>(<span class="kw">strsplit</span>(group_comm_names, <span class="st">&quot;[.]&quot;</span>)),</a>
<a class="sourceLine" id="cb135-3" title="3">                           <span class="kw">nrow</span>(snake.ellipses), <span class="dv">2</span>, <span class="dt">byrow =</span> <span class="ot">TRUE</span>)<span class="co">#splitting communit and group</span></a></code></pre></div>
<pre><code>## Error in strsplit(group_comm_names, &quot;[.]&quot;): object &#39;group_comm_names&#39; not found</code></pre>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb137-1" title="1">snake.ellipses<span class="op">$</span>community &lt;-<span class="st"> </span>split_group_comm[,<span class="dv">1</span>]</a></code></pre></div>
<pre><code>## Error in eval(expr, envir, enclos): object &#39;split_group_comm&#39; not found</code></pre>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb139-1" title="1">snake.ellipses<span class="op">$</span>group     &lt;-<span class="st"> </span>split_group_comm[,<span class="dv">2</span>]</a></code></pre></div>
<pre><code>## Error in eval(expr, envir, enclos): object &#39;split_group_comm&#39; not found</code></pre>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb141-1" title="1">snake.ellipses &lt;-<span class="st"> </span>dplyr<span class="op">::</span><span class="kw">rename</span>(snake.ellipses, <span class="dt">iso1 =</span> x, <span class="dt">iso2 =</span> y, </a>
<a class="sourceLine" id="cb141-2" title="2">                                <span class="dt">Species =</span> community, <span class="dt">Tissue =</span> group)</a></code></pre></div>
<pre><code>## Error: Can&#39;t rename columns that don&#39;t exist.
## [31mx[39m Column `x` doesn&#39;t exist.</code></pre>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb143-1" title="1"><span class="co">#Plotting 10 randomly sampled ellipses</span></a>
<a class="sourceLine" id="cb143-2" title="2"></a>
<a class="sourceLine" id="cb143-3" title="3">siber_snakes<span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb143-4" title="4"><span class="st">  </span><span class="kw">rename</span>(<span class="dt">Species =</span> community,</a>
<a class="sourceLine" id="cb143-5" title="5">         <span class="dt">Tissue =</span> group)<span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb143-6" title="6"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(iso1, iso2, <span class="dt">col =</span> Species))<span class="op">+</span></a>
<a class="sourceLine" id="cb143-7" title="7"><span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">shape =</span> Species), <span class="dt">size =</span> <span class="dv">2</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb143-8" title="8"><span class="st">  </span><span class="kw">ylab</span>(<span class="kw">expression</span>(<span class="kw">paste</span>(delta<span class="op">^</span>{<span class="dv">15</span>}, <span class="st">&quot;N (\u2030)&quot;</span>)))<span class="op">+</span></a>
<a class="sourceLine" id="cb143-9" title="9"><span class="st">  </span><span class="kw">xlab</span>(<span class="kw">expression</span>(<span class="kw">paste</span>(delta<span class="op">^</span>{<span class="dv">13</span>}, <span class="st">&quot;C (\u2030)&quot;</span>)))<span class="op">+</span></a>
<a class="sourceLine" id="cb143-10" title="10"><span class="st">  </span><span class="kw">geom_polygon</span>(<span class="dt">data =</span> snake.ellipses,</a>
<a class="sourceLine" id="cb143-11" title="11">               <span class="dt">mapping =</span> <span class="kw">aes</span>(iso1, iso2, <span class="dt">group =</span> rep, <span class="dt">linetype =</span> Species, <span class="dt">col =</span> Species),</a>
<a class="sourceLine" id="cb143-12" title="12">               <span class="dt">fill =</span> <span class="ot">NA</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb143-13" title="13"><span class="st">  </span><span class="kw">scale_color_brewer</span>(<span class="dt">palette =</span> <span class="st">&quot;Set1&quot;</span>, <span class="dt">direction =</span> <span class="dv">-1</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb143-14" title="14"><span class="st">  </span><span class="kw">scale_fill_brewer</span>(<span class="dt">palette =</span> <span class="st">&quot;Set1&quot;</span>, <span class="dt">direction =</span> <span class="dv">-1</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb143-15" title="15"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>Tissue)<span class="op">+</span></a>
<a class="sourceLine" id="cb143-16" title="16"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.text =</span> <span class="kw">element_text</span>(<span class="dt">face =</span> <span class="st">&quot;italic&quot;</span>))</a></code></pre></div>
<pre><code>## Error in eval(lhs, parent, parent): object &#39;siber_snakes&#39; not found</code></pre>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb145-1" title="1"><span class="kw">ggsave</span>(<span class="kw">last_plot</span>(), <span class="dt">filename =</span> <span class="st">&quot;../Figures and Tables/figure3.tiff&quot;</span>, <span class="dt">height =</span> <span class="fl">4.5</span>, <span class="dt">width =</span> <span class="dv">8</span>)</a></code></pre></div>
<p>As seen in the SEA estimation, low sample size for <em>H. curtus</em> causes greater uncertainty in the estimation of standar ellipses even with bayesian inference. Both carbon and nitrogen isotpes seem to be enriched in scales when compared to plasma. Degree of overlap appears to be low for both tissues.</p>
<ul>
<li>Samples sizes for <em>H. curtus</em> in both tissues need to be increased despite using bayesian methods</li>
<li><strong>Unusual outlier</strong> in <em>H. schistosus</em> scales data needs to be checked</li>
</ul>
</div>
<div id="relative-overlap-in-bayesian-standard-ellipses" class="section level2">
<h2><span class="header-section-number">4.5</span> Relative overlap in bayesian standard ellipses</h2>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb146-1" title="1"><span class="co">#Overlap in ellipse based on plasma samples</span></a>
<a class="sourceLine" id="cb146-2" title="2">snake.p.overlap &lt;-<span class="st"> </span><span class="kw">bayesianOverlap</span>(<span class="dt">ellipse1 =</span> <span class="st">&quot;Hydrophis schistosus.Plasma&quot;</span> , <span class="co">#Group 1</span></a>
<a class="sourceLine" id="cb146-3" title="3">                                   <span class="dt">ellipse2 =</span> <span class="st">&quot;Hydrophis curtus.Plasma&quot;</span>, <span class="co">#Group 2</span></a>
<a class="sourceLine" id="cb146-4" title="4">                                   snakes.post, <span class="co">#list with posteriour dists</span></a>
<a class="sourceLine" id="cb146-5" title="5">                                   <span class="dt">draws =</span> <span class="dv">100</span>, <span class="dt">p.interval =</span> <span class="fl">0.95</span>, <span class="dt">n =</span> <span class="dv">100</span>) <span class="co">#params</span></a></code></pre></div>
<pre><code>## Error in matrix(ellipses.posterior[[ellipse1]][i, 1:4], nrow = 2, ncol = 2): object &#39;snakes.post&#39; not found</code></pre>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb148-1" title="1">snake.p.overlap &lt;-<span class="st"> </span>snake.p.overlap<span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb148-2" title="2"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Turnover =</span> <span class="st">&quot;Short-term&quot;</span>)</a></code></pre></div>
<pre><code>## Error in eval(lhs, parent, parent): object &#39;snake.p.overlap&#39; not found</code></pre>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb150-1" title="1"><span class="co">#overlap in ellipse based on scale samples</span></a>
<a class="sourceLine" id="cb150-2" title="2">snake.s.overlap &lt;-<span class="st"> </span><span class="kw">bayesianOverlap</span>(<span class="dt">ellipse1 =</span> <span class="st">&quot;Hydrophis schistosus.Scales&quot;</span> , <span class="co">#Group 1</span></a>
<a class="sourceLine" id="cb150-3" title="3">                                   <span class="dt">ellipse2 =</span> <span class="st">&quot;Hydrophis curtus.Scales&quot;</span>, <span class="co">#Group 2</span></a>
<a class="sourceLine" id="cb150-4" title="4">                                   snakes.post, <span class="co">#list with posteriour dists</span></a>
<a class="sourceLine" id="cb150-5" title="5">                                   <span class="dt">draws =</span> <span class="dv">100</span>, <span class="dt">p.interval =</span> <span class="fl">0.95</span>, <span class="dt">n =</span> <span class="dv">100</span>) <span class="co">#params</span></a></code></pre></div>
<pre><code>## Error in matrix(ellipses.posterior[[ellipse1]][i, 1:4], nrow = 2, ncol = 2): object &#39;snakes.post&#39; not found</code></pre>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb152-1" title="1">snake.s.overlap &lt;-<span class="st"> </span>snake.s.overlap<span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb152-2" title="2"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Turnover =</span> <span class="st">&quot;Long-term&quot;</span>)</a></code></pre></div>
<pre><code>## Error in eval(lhs, parent, parent): object &#39;snake.s.overlap&#39; not found</code></pre>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb154-1" title="1">snake.overlap &lt;-<span class="st"> </span><span class="kw">bind_rows</span>(snake.p.overlap, snake.s.overlap)</a></code></pre></div>
<pre><code>## Error in dots_values(...): object &#39;snake.p.overlap&#39; not found</code></pre>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb156-1" title="1">snake.overlap<span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb156-2" title="2"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">prop.overlap =</span> overlap<span class="op">/</span>(area1 <span class="op">+</span><span class="st"> </span>area2 <span class="op">-</span><span class="st"> </span>overlap))<span class="op">%&gt;%</span><span class="st"> </span><span class="co">#relative overlap</span></a>
<a class="sourceLine" id="cb156-3" title="3"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(prop.overlap))<span class="op">+</span></a>
<a class="sourceLine" id="cb156-4" title="4"><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">bins =</span> <span class="dv">10</span>, <span class="dt">col =</span> <span class="st">&quot;black&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb156-5" title="5"><span class="st">  </span><span class="co">#geom_vline(aes(xintercept = mean(prop.overlap),  col = &quot;red&quot;), size = 1)+</span></a>
<a class="sourceLine" id="cb156-6" title="6"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Proportion of overlap&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Number of samples&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb156-7" title="7"><span class="st">  </span><span class="kw">scale_color_discrete</span>(<span class="dt">name =</span> <span class="st">&quot;Mean&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb156-8" title="8"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>Turnover)</a></code></pre></div>
<pre><code>## Error in eval(lhs, parent, parent): object &#39;snake.overlap&#39; not found</code></pre>
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb158-1" title="1">snake.overlap<span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb158-2" title="2"><span class="st">  </span><span class="kw">group_by</span>(Turnover)<span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb158-3" title="3"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">prop.overlap =</span> overlap<span class="op">/</span>(area1 <span class="op">+</span><span class="st"> </span>area2 <span class="op">-</span><span class="st"> </span>overlap))<span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb158-4" title="4"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">Avg.overlap =</span> <span class="kw">mean</span>(prop.overlap),</a>
<a class="sourceLine" id="cb158-5" title="5">            <span class="dt">sd =</span> <span class="kw">sd</span>(prop.overlap))</a></code></pre></div>
<pre><code>## Error in eval(lhs, parent, parent): object &#39;snake.overlap&#39; not found</code></pre>
<p>Overlap between <em>H. curtus</em> and <em>H. schistosus</em> seems to be high in when comparing long term resource use, i.e., scales.</p>
<p>However, overlap between <em>H. curtus</em> and <em>H. schistosus</em> seems to be very low when comparing short term resource use, i.e., plasma.</p>
<p>This difference could be caused by:</p>
<ul>
<li>low sample size for <em>H. curtus</em></li>
<li>differences in processing of scales and plasma, i.e., lipid extraction</li>
</ul>

<div class="sourceCode" id="cb160"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb160-1" title="1"><span class="co"># importing libraries</span></a>
<a class="sourceLine" id="cb160-2" title="2"></a>
<a class="sourceLine" id="cb160-3" title="3"><span class="kw">library</span>(tidyverse)</a>
<a class="sourceLine" id="cb160-4" title="4"><span class="kw">library</span>(lubridate)</a>
<a class="sourceLine" id="cb160-5" title="5"><span class="kw">library</span>(viridis)</a></code></pre></div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="difference-in-diet-between-h-curtus-and-h-schsitosus.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="varition-in-fishing-intensity-along-the-sindhudurg-coast.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
