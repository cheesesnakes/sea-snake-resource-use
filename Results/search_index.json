[
["index.html", "Resouce use in two sympatric species of sea snakes in anthropogenically dominated seascape 1 Introduction 1.1 Citation", " Resouce use in two sympatric species of sea snakes in anthropogenically dominated seascape Shawn Dsouza, Chetan Rao, Muralidharan M., and Kartik Shanker 2020-07-27 1 Introduction This file contains the code for analysis in R for a study about resources use in sea snakes on the west coast of India. The core message of this manuscripts are as follows: Resource use differs between H. curtus and H. schistosus Variation in fishing intensity of trawlers and gillnets affects patterns of resource use We used a combination of approaches including: fisheries dependent methods to characterise distribution and habitat use of the two species, and spatial overlap with fishing; visual gut content analysis to characterise diet and trophic niche of the species, and overlap between fisheries catch and sea snake diet; stable isotope analysis to characterise overall resource use in terms of isotopic niche, as well as the effect of fishing intensity on the niche width of both species. 1.1 Citation Add link/citation "],
["difference-in-distribution-and-habitat-use-between-h-curtus-and-h-shcistosus.html", "2 Difference in distribution and habitat use between H. curtus and H. shcistosus 2.1 Calculating abundance of sea snakes per fishing trip 2.2 Sample size 2.3 Geocoding sea snake encounters 2.4 Mean CPUE by species 2.5 Area used by species 2.6 Mapping sea snake distributions 2.7 Summarising depth use by species 2.8 Spatial segregation by species 2.9 Modelling depth use by species", " 2 Difference in distribution and habitat use between H. curtus and H. shcistosus We investigated the study species used ssimilar areas for foraging and other activities using survey data gathered from fishermen. We tested differences in depth use and overlap in space. 2.1 Calculating abundance of sea snakes per fishing trip snakes_den = snakes%&gt;% filter(Species == &quot;Hydrophis schistosus&quot; | Species == &quot;Hydrophis curtus&quot;, Fishing.Location != &quot;&quot;, !is.na(Depth.Caught..m.))%&gt;% dplyr::select(Species, Fishing.Location, Depth.Caught..m., Date, Boat.Name.Owner, # selecting relevant variables No..of.Hauls, Average.Haul.Duration..Hours., Gear.Type)%&gt;% group_by(Gear.Type)%&gt;% # completing missing effort data mutate(n.hauls = ifelse(is.na(No..of.Hauls), median(No..of.Hauls, na.rm = T), No..of.Hauls), haul.time = ifelse(is.na(Average.Haul.Duration..Hours.), median(Average.Haul.Duration..Hours., na.rm = T), Average.Haul.Duration..Hours.))%&gt;% group_by(Date, Boat.Name.Owner)%&gt;% summarise(HC = sum(Species == &quot;Hydrophis curtus&quot;), # calculating abundance per trip HS = sum(Species == &quot;Hydrophis schistosus&quot;), effort = last(n.hauls*haul.time), # calculating fishing effort per trip Fishing.Location = last(Fishing.Location), Depth.Caught..m. = last(Depth.Caught..m.))%&gt;% gather(c(&quot;HC&quot;, &quot;HS&quot;), value = n, key = &quot;Species&quot;)%&gt;% mutate(CPUE = n/effort)%&gt;% # calculating catch per unit effort of each specie per trip drop_na() # removing missing values 2.2 Sample size The number of trips and total haul hours sampled by gear. snakes%&gt;% filter(Species == &quot;Hydrophis schistosus&quot; | Species == &quot;Hydrophis curtus&quot;, Fishing.Location != &quot;&quot;, !is.na(Depth.Caught..m.))%&gt;% dplyr::select(Species, Fishing.Location, Depth.Caught..m., Date, Boat.Name.Owner, # selecting relavant variables No..of.Hauls, Average.Haul.Duration..Hours., Gear.Type)%&gt;% group_by(Gear.Type)%&gt;% # filling in missing effort data mutate(n.hauls = ifelse(is.na(No..of.Hauls), median(No..of.Hauls, na.rm = T), No..of.Hauls), haul.time = ifelse(is.na(Average.Haul.Duration..Hours.), median(Average.Haul.Duration..Hours., na.rm = T), Average.Haul.Duration..Hours.))%&gt;% group_by(Gear.Type, Date, Boat.Name.Owner)%&gt;% summarise(effort = last(n.hauls*haul.time))%&gt;% # calculating effort per trip group_by(Gear.Type)%&gt;% summarise(n_trips = n(), effort = sum(effort))%&gt;% drop_na() Gear.Type n_trips effort GillNet 198 270.56 Rampan 30 107.45 Trawler 20 92.75 snakes%&gt;% filter(Species == &quot;Hydrophis schistosus&quot; | Species == &quot;Hydrophis curtus&quot;)%&gt;% summarise(HS = sum(Species == &quot;Hydrophis schistosus&quot;), HC = sum(Species == &quot;Hydrophis curtus&quot;)) HS HC 605 179 2.3 Geocoding sea snake encounters In order to map sea snake distribution and study depth use we used location and depth data gathered from fisher surveys to map each fishing trip. The protocol for geocoding fishing trips is as follows: Nearest landmarks are geocoded from google maps API Latitude is extracted from landmark geocode Match landmark latitude and depth from survey to GEBCO data Extract final longitude from GEBCO data The protocol is encoded in Function/geocode.R source(&quot;./Functions/geocode.R&quot;) snakes_den &lt;- geocode.trips(snakes_den, fl = &#39;Fishing.Location&#39;, dep = &#39;Depth.Caught..m.&#39;) # removing duplicates introduced by fuzzy joining snakes_den &lt;- distinct(snakes_den, Date, Boat.Name.Owner, Species, Fishing.Location, Depth.Caught..m., .keep_all = T) # saving output write.csv(snakes_den, &quot;./Data/snakes-density.csv&quot;) Note: fuzzyjoin::fuzzy_inner_join() introduces many duplicates, I have not as yet been able to fix the issue dirrectly. Currently, removing duplicates from output using dplyr::distinct(). 2.4 Mean CPUE by species Each fishing trip is assigned to a cell in the sampling grid. Total CPUE of each species in each grid cell is then calculated. # loading libraries library(raster) # raster with study site extent ext &lt;- raster(&quot;./Data/sampling_extent.tif&quot;) # importing functions source(&quot;./Functions/intensity extract.R&quot;) source(&quot;./Functions/raster to df.R&quot;) ## Calculating sea snake CPUE den &lt;- snakes_den%&gt;% group_by(Species)%&gt;% nest()%&gt;% mutate(m = map(data, ~map.extract(df = ., var = &quot;n&quot;, func = &#39;sum&#39;)), mdf = map(m, map.df))%&gt;% dplyr::select(mdf)%&gt;% unnest()%&gt;% spread(Species, layer) # Mean, sd CPUE den%&gt;% skimr::skim(HC, HS)%&gt;% skimr::yank(&quot;numeric&quot;)%&gt;% dplyr::select(-hist) Variable type: numeric skim_variable n_missing complete_rate mean sd p0 p25 p50 p75 p100 HC 0 1 0.16 1.22 0 0 0 0 14.78 HS 0 1 0.54 4.38 0 0 0 0 86.78 2.5 Area used by species The area (km^2) occupied by a species calculated as the number of grid cells that a species was found in multiplied the area of each cell (10 sq. km.). snakes_den%&gt;% group_by(Species)%&gt;% nest()%&gt;% mutate(m = map(data, ~map.extract(df = ., var = &quot;CPUE&quot;, func = &#39;sum&#39;)), mdf = map(m, map.df))%&gt;% dplyr::select(mdf)%&gt;% summarise(spatial_extent = map(mdf, ~sum(.$layer&gt;0)))%&gt;% unnest()%&gt;% mutate(spatial_extent = spatial_extent*10) Species spatial_extent HC 540 HS 610 2.6 Mapping sea snake distributions ## importing required libraries library(marmap) library(ggmap) ## getting deoth data downloaded from GEBCO depth &lt;- readGEBCO.bathy(&quot;./Data/gebco_2020_n16.7_s15.5_w72.0_e73.9.nc&quot;) depth = fortify.bathy(depth)%&gt;% # converting to usable data frame dplyr::rename(lon = x, lat = y, depth = z)%&gt;% filter(depth &lt; 1) ## Getting base map base &lt;- get_googlemap(center = c(mean(snakes_den$lon),mean(snakes_den$lat)), zoom = 9, scale = 4, maptype = &quot;terrain&quot;)##Getting basemap ## importing plotting function source(&quot;./Functions/intensity_plot.R&quot;) ## making plot snake_plot &lt;- snakes_den%&gt;% mutate(Species = ifelse(Species == &quot;HC&quot;, &quot;Hydrophis curtus&quot;, &quot;Hydrophis schistosus&quot;))%&gt;% group_by(Species)%&gt;% nest()%&gt;% mutate(m = map(data, ~map.extract(df = ., var = &quot;CPUE&quot;, func = &#39;sum&#39;)), mdf = map(m, map.df), plot = map2(mdf, Species, ~int.plot(mdf = ., Species, name = &quot;CPUE&quot;, title.face = &quot;italic&quot;)))%&gt;% gridExtra::grid.arrange(grobs = .$plot, ncol = 2) ## saving high res figure ggsave(snake_plot, filename = &quot;./Figures and Tables/figure1.tiff&quot;, width = 8, height = 6, dpi = 300) Figure 1: Distribution and depth use of sea snake in the near shore waters of Sindhudurg, Maharashtra based on fisheries dependent data. 2.7 Summarising depth use by species # Calculating mean depth in cell dep &lt;- depth%&gt;% nest()%&gt;% mutate(m = map(data, ~map.extract(df = ., var = &quot;depth&quot;, func = mean)), mdf = map(m, map.df))%&gt;% dplyr::select(mdf)%&gt;% unnest()%&gt;% rename(mean.depth = layer) #Calculating relative abaundance of sea snakes in each cell den&lt;- den%&gt;% inner_join(dep, by = c(&quot;x&quot;, &quot;y&quot;))%&gt;% mutate(rel.prop = HC/(HC+HS)) # Relative proportion of H. curtus with depth den%&gt;% gather(c(&quot;HS&quot;, &quot;HC&quot;), key = sp, value = CPUE)%&gt;% filter(CPUE&gt;0)%&gt;% group_by(sp)%&gt;% skimr::skim(mean.depth)%&gt;% skimr::yank(&quot;numeric&quot;)%&gt;% dplyr::select(-hist) Variable type: numeric skim_variable sp n_missing complete_rate mean sd p0 p25 p50 p75 p100 mean.depth HC 0 1 -28.55 12.10 -48.29 -37.67 -30.20 -20.21 -1.56 mean.depth HS 0 1 -18.26 10.35 -39.33 -24.23 -17.82 -9.49 -1.53 2.8 Spatial segregation by species We caluclated the spatial overlap between H. curtus and H. schistosus as the area (number of cells*10 sq. km.) in which both species occured together divided the by the total area in which atleast one of the species occured. den%&gt;% summarise(total.extent = sum(HC&gt;0 | HS&gt;0)*10, overlap = sum(HC &gt; 0 &amp; HS &gt; 0)*10, relative_overlap = overlap/total.extent) total.extent overlap relative_overlap 860 290 0.3372093 2.9 Modelling depth use by species # t-test for cell depth den%&gt;% gather(c(&quot;HS&quot;, &quot;HC&quot;), key = sp, value = CPUE)%&gt;% filter(CPUE&gt;0)%&gt;% dplyr::select(sp, mean.depth)%&gt;% nest()%&gt;% mutate(mod = map(data, ~t.test(mean.depth ~ sp, data = .)), sumry = map(mod, broom::tidy), d = map(data, ~lsr::cohensD(mean.depth ~ sp, data = .)))%&gt;% dplyr::select(sumry, d)%&gt;% unnest()%&gt;% dplyr::select(estimate:p.value, d) estimate estimate1 estimate2 statistic p.value d -10.28462 -28.54587 -18.26125 -4.865557 4e-06 0.9177882 # testing effect of cell depth on relative abundance den%&gt;% gather(c(&quot;HS&quot;, &quot;HC&quot;), key = sp, value = CPUE)%&gt;% mutate(rel.prop = ifelse(sp == &quot;HS&quot;, 1 - rel.prop, rel.prop), mean.depth = -mean.depth)%&gt;% dplyr::select(sp, rel.prop, mean.depth)%&gt;% group_by(sp)%&gt;% nest()%&gt;% mutate(prop_dep = map(data, ~lm(rel.prop ~ mean.depth, data = .)), sumry = map(prop_dep, broom::tidy), stat = map(prop_dep, broom::glance))%&gt;% dplyr::select(sumry, stat)%&gt;% unnest()%&gt;% dplyr::select(sp:p.value, adj.r.squared) sp term estimate std.error statistic p.value adj.r.squared HS (Intercept) 1.2403231 0.0712075 17.41844 0.0000000 0.5424777 HS mean.depth -0.0265266 0.0026293 -10.08877 0.0000000 0.5424777 HC (Intercept) -0.2403231 0.0712075 -3.37497 0.0011194 0.5424777 HC mean.depth 0.0265266 0.0026293 10.08877 0.0000000 0.5424777 H. curtus was caught in deeper habitats than H. schistosus. "],
["difference-in-diet-between-h-curtus-and-h-schsitosus.html", "3 DIfference in diet between H. curtus and H. schsitosus 3.1 No. of samples collected by sea snake species 3.2 Proportion of unidentified specimens 3.3 Prey preference 3.4 Range of prey found in H. curtus and H. shistosus gut 3.5 Diet overlap between H. curtus and H. shistosus 3.6 Difference in size selectivity of prey between H. curtus and H. schistosus", " 3 DIfference in diet between H. curtus and H. schsitosus 3.1 No. of samples collected by sea snake species snakes%&gt;% filter(Species == &quot;Hydrophis curtus&quot; | Species == &quot;Hydrophis schistosus&quot;)%&gt;% group_by(Species)%&gt;% summarise(N = n(), # total number of individuals sampled n = sum((Gut.Content) == &quot;Yes&quot;), # number of individuals with gut content n_male = sum((Gut.Content) == &quot;Yes&quot; &amp; Sex == &quot;Male&quot;), # males with gut content n_female = sum((Gut.Content) == &quot;Yes&quot; &amp; Sex == &quot;Female&quot;), # females with content prop.unid = n/N) # propotion of individuals with gut content Species N n n_male n_female prop.unid Hydrophis curtus 179 36 18 18 0.2011173 Hydrophis schistosus 605 93 55 36 0.1537190 A very low proportion of inviduals had gut content present at the time of sampling. Sampling accross species and sexes may be adequate for comparison. 3.2 Proportion of unidentified specimens # importing gut content data gc = read.csv(&quot;./Data/Sea_snakes_gut_content_2018-19.csv&quot;)%&gt;% filter(Source == &quot;Gut content&quot;) # removing specimens collected from fisheries landings # calculating richness gc%&gt;% filter(Source == &quot;Gut content&quot;)%&gt;% summarise(N_sp = length(unique(Prey.Species)), # number of prey species N_fam = length(unique(Prey.Family)), # number of prey families # proportion of unidentitified specimens unid_sp = sum(Prey.Species == &quot;Unidentified&quot; | Prey.Species == &quot;&quot;, na.rm = T)*100/n(), ## species unid_fam = sum(Prey.Family == &quot;Unidentified&quot; | Prey.Family == &quot;&quot;, na.rm = T)*100/n())%&gt;% ## family # creating clean table gather()%&gt;% mutate(Metric = ifelse(substr(key, 1, 1) == &quot;N&quot;, &quot;N&quot;, &quot;% Unidentified&quot;), Unit = ifelse(grepl(key, pattern = &quot;sp&quot;, fixed = T), &quot;Prey Species&quot;, &quot;Prey Family&quot;))%&gt;% dplyr::select(Unit, Metric, value)%&gt;% spread(Metric, value) Unit % Unidentified N Prey Family 29.45736 18 Prey Species 40.31008 26 A large portion of gut content specimens were unidentifiable. This is an unavoidable consquence of VGCA. 3.3 Prey preference We modified and used the the Index of relative importance according to Pinkas et al. 1971 to determine the difference in prey preference between H. curtus and H. schistosus # calulating index of relative importance (Pinkas et al. 1971) IRI &lt;- gc%&gt;% filter(Prey.Family != &quot;&quot;)%&gt;% filter(Snake.Species == &quot;Hydrophis schistosus&quot; | Snake.Species == &quot;Hydrophis curtus&quot;)%&gt;% group_by(Snake.Species)%&gt;% mutate(Fr = length(unique(Field.Code)), # total number of snakes sampled W = sum(Weight..g., na.rm = T), # total weight of prey sampled N = n())%&gt;% # total number of prey sampled group_by(Snake.Species, Prey.Family)%&gt;% summarise(f = length(unique(Field.Code)), # number snakes in which prey family occured Fr = last(Fr), w = sum(Weight..g., na.rm = T), # weight of prey family W = last(W), n = n(), # number of individuals of prey family N = last(N))%&gt;% group_by(Snake.Species, Prey.Family)%&gt;% # caluclating percentages summarise(per.F = f*100/Fr, per.W = w*100/W, per.N = n*100/N, # caluclating IRI IRI = (per.N + per.W)*per.F)%&gt;% arrange(Snake.Species, desc(IRI))%&gt;% mutate(rank = 1:n()) # clean table knitr::kable(IRI) Snake.Species Prey.Family per.F per.W per.N IRI rank Hydrophis curtus Unidentified 44.827586 15.2823920 40.625000 2506.193436 1 Hydrophis curtus Clupeidae 6.896552 29.9003322 9.375000 270.864360 2 Hydrophis curtus Engraulidae 10.344828 11.9601329 9.375000 220.708271 3 Hydrophis curtus Carangidae 13.793103 3.3222591 12.500000 218.238057 4 Hydrophis curtus Scombridae 6.896552 6.6445183 6.250000 88.927712 5 Hydrophis curtus Cynoglossidae 6.896552 3.9867110 6.250000 70.598007 6 Hydrophis curtus Serranidae 3.448276 16.6112957 3.125000 68.056192 7 Hydrophis curtus Leiognathidae 6.896552 2.9900332 6.250000 63.724367 8 Hydrophis curtus Tetraodontidae 3.448276 7.6411960 3.125000 37.124814 9 Hydrophis curtus Nemipteridae 3.448276 1.6611296 3.125000 16.503895 10 Hydrophis schistosus Tetraodontidae 34.246575 38.7307267 35.869565 2554.804519 1 Hydrophis schistosus Unidentified 23.287671 12.9453244 21.739130 807.720182 2 Hydrophis schistosus Ariidae 9.589041 8.8407094 8.695652 168.156891 3 Hydrophis schistosus Clupeidae 6.849315 10.9456402 6.521739 119.639584 4 Hydrophis schistosus Plotosidae 8.219178 7.7882440 6.521739 117.616299 5 Hydrophis schistosus Teraponidae 6.849315 6.5673841 5.434783 82.206621 6 Hydrophis schistosus Serranidae 5.479452 7.6303742 5.434783 71.589900 7 Hydrophis schistosus Leiognathidae 4.109589 1.0524654 3.260870 17.726034 8 Hydrophis schistosus Sillaginidae 1.369863 2.4206704 1.086957 4.804968 9 Hydrophis schistosus Scombridae 1.369863 1.2103352 1.086957 3.146975 10 Hydrophis schistosus Synodontidae? 1.369863 1.1840236 1.086957 3.110932 11 Hydrophis schistosus Pleuronectidae 1.369863 0.3683629 1.086957 1.993588 12 Hydrophis schistosus Carangidae 1.369863 0.3157396 1.086957 1.921502 13 Hydrophis schistosus Synodontidae 1.369863 0.0000000 1.086957 1.488981 14 # plotting prey preference IRI%&gt;% ggplot(aes(Prey.Family, IRI, fill = Snake.Species))+ geom_col(col = &quot;black&quot;, position = position_dodge(preserve = &quot;single&quot;))+ scale_y_sqrt(name = &quot;IRI (sq.rt.)&quot;)+ labs(x = &quot;Prey Family&quot;)+ scale_fill_brewer(palette = &quot;Greys&quot;, name = &quot;Snake Species&quot;)+ theme(axis.text.x = element_text(hjust = 1, angle = 60), legend.text = element_text(face = &quot;italic&quot;)) # saving high res plot ggsave(last_plot(), filename = &quot;./Figures and Tables/figure2.tiff&quot;, width = 8, height = 6, dpi = 300) Figure 2: Index of relative importance (IRI, square root transformed) (Pinkas et al., 1970) of prey families in sea snake diet. H. schistosus showed preference for the Tetraodontid fish, while H. curtus did not exhibit any prey preference. 3.4 Range of prey found in H. curtus and H. shistosus gut We compared the dietary breadth between snakes species using the richness and diversity of prey families. # Creating data martix for prey community analysis analysis fam_vegan = gc%&gt;% filter(Prey.Family != &quot;Unidentified&quot;)%&gt;% # removing unidentified specimens group_by(Snake.Species, Prey.Family)%&gt;% summarise(n = n())%&gt;% # total number of specimens per family in each snake species group_by(Snake.Species)%&gt;% mutate(t = sum(n))%&gt;% # total number of specimens for each snake species group_by(Snake.Species, Prey.Family)%&gt;% summarise(p = n/t)%&gt;% # relative proportion spread(Prey.Family, p, fill = 0)%&gt;% column_to_rownames(&quot;Snake.Species&quot;) 3.4.1 Prey richness gc%&gt;% filter(Snake.Species == &quot;Hydrophis schistosus&quot; | Snake.Species == &quot;Hydrophis curtus&quot;, Prey.Species != &quot;Unidentified&quot;)%&gt;% group_by(Snake.Species)%&gt;% summarise(Prey.Species = length(unique(Prey.Species)), Prey.Families = length(unique(Prey.Family))) Snake.Species Prey.Species Prey.Families Hydrophis curtus 11 10 Hydrophis schistosus 20 11 3.4.2 Prey family diversity # loading libraries library(vegetarian) ## for community indices # calculating shanon diversity data.frame( hs = d(fam_vegan[-1,], &quot;alpha&quot;, boot = T), ## for Hydrophis schistosus hc = d(fam_vegan[-2,], &quot;alpha&quot;, boot = T) ## for Hydropis schistosus )%&gt;% # creating a clean table gather()%&gt;% mutate(Species = ifelse(substr(key, 1, 2) == &quot;hs&quot;, &quot;Hydrophis schistosus&quot;, &quot;Hydrophis curtus&quot;), Metric = ifelse(substr(key, 4, 4) == &quot;D&quot;, &quot;Shanon Diversity&quot;, &quot;Standard Error&quot;))%&gt;% dplyr::select(Species, Metric, value)%&gt;% spread(Metric, value) Species Shanon Diversity Standard Error Hydrophis curtus 9.029676 0 Hydrophis schistosus 7.019472 0 While H. schistosus fed on greater number of prey families, H. curtus showed greater evenness in prey preference. Statistical comparison is difficult as each individual snake fed on only one type of specimen at time. 3.5 Diet overlap between H. curtus and H. shistosus Number of overlapping prey families: gc%&gt;% filter(Snake.Species == &quot;Hydrophis schistosus&quot; | Snake.Species == &quot;Hydrophis curtus&quot;, Prey.Family != &quot;Unidentified&quot;)%&gt;% group_by(Prey.Family)%&gt;% summarise(N_pred = length(unique(Snake.Species)))%&gt;% ungroup()%&gt;% summarise(Overlap = sum(N_pred&gt;1))%&gt;% as.numeric() ## [1] 7 Shoener’s (1971) resource overlap index (D): gc%&gt;% filter(Prey.Species != &quot;Unidentified&quot;)%&gt;% group_by(Snake.Species, Prey.Family)%&gt;% summarise(n = n())%&gt;% # number of speciemens per prey family in each snake species group_by(Snake.Species)%&gt;% mutate(N = sum(n))%&gt;% # total number of specimens collected from each snake species group_by(Snake.Species, Prey.Family)%&gt;% summarise(p = n/N)%&gt;% # relative proportion of each prey family spread(Snake.Species, p, fill = 0)%&gt;% rename(&quot;HC&quot; = &#39;Hydrophis curtus&#39;, &quot;HS&quot; = &#39;Hydrophis schistosus&#39;)%&gt;% mutate(P = abs(HC - HS))%&gt;% # difference in relactive proportion prey items summarise(D = 1 - 0.5*sum(P))%&gt;% # Schoener&#39;s resource overlap index as.numeric() ## [1] 0.2380952 Morista - Horn overlap: similarity(fam_vegan, q = 2, boot = T)%&gt;% as.data.frame() Simlarity StdErr 0.2552632 0.2179449 There was limited overlap in prey between H. schistosus and H. curtus 3.5.1 Testing segregation in prey between H. curtus and H. schistosus # loading libraries library(vegan) # formating data for vegan fam_simboo &lt;- gc%&gt;% filter(Prey.Family != &quot;Unidentified&quot;, Prey.Family !=&quot;&quot;, Field.Code != &quot;&quot;)%&gt;% group_by(Snake.Species, Field.Code, Prey.Family)%&gt;% summarise(n = n())%&gt;% spread(Prey.Family, n, fill = 0)%&gt;% ungroup() # PERMANOVA to compare composition set.seed(2) permanova_sp &lt;- adonis2(fam_simboo[,3:length(fam_simboo)] ~ fam_simboo$Snake.Species, data = fam_simboo[,1]) ## clean table broom::tidy(permanova_sp) term df SumOfSqs R2 statistic p.value fam_simboo$Snake.Species 1 1.552381 0.0509692 3.759463 0.002 Residual 70 28.904841 0.9490308 Total 71 30.457222 1.0000000 Prey composition was significantly different between the two snake species. 3.6 Difference in size selectivity of prey between H. curtus and H. schistosus # summary gc%&gt;% filter(Snake.Species == &quot;Hydrophis schistosus&quot; | Snake.Species == &quot;Hydrophis curtus&quot;, Condition &lt; 3)%&gt;% # removing very digested specimens group_by(Snake.Species)%&gt;% skimr::skim(Maximum.Body.Girth..cm.)%&gt;% skimr::yank(&quot;numeric&quot;)%&gt;% dplyr::select(Snake.Species:p100) Variable type: numeric Snake.Species n_missing complete_rate mean sd p0 p25 p50 p75 p100 Hydrophis curtus 2 0.86 2.77 0.76 2.0 2.08 2.65 3.2 4.5 Hydrophis schistosus 0 1.00 3.46 1.17 0.6 3.00 3.60 4.3 5.5 # testing diff max prey width by species gc%&gt;% filter(Snake.Species == &quot;Hydrophis schistosus&quot; | Snake.Species == &quot;Hydrophis curtus&quot;, Condition &lt; 3, # removing digested specimens !is.na(Maximum.Body.Girth..cm.))%&gt;% # removing unrecorded data dplyr::select(Snake.Species, Maximum.Body.Girth..cm.)%&gt;% droplevels()%&gt;% nest()%&gt;% mutate(test = map(data, ~t.test(Maximum.Body.Girth..cm. ~ Snake.Species, data = .)), # t test sumry = map(test, broom::tidy), d = map(data, ~lsr::cohensD(Maximum.Body.Girth..cm. ~ Snake.Species, data = .)))%&gt;% # effect size dplyr::select(sumry, d)%&gt;% unnest()%&gt;% dplyr::select(estimate1:p.value, d)%&gt;% rename(`Hydrophis curtus` = estimate1, `Hydrophis schistosus` = estimate2) Hydrophis curtus Hydrophis schistosus statistic p.value d 2.76775 3.463946 -2.386272 0.0237889 0.6420566 H. schistosus fed on larger prey than H. curtus "],
["difference-in-resouce-use-betweek-h-curtus-and-h-schistosus.html", "4 Difference in resouce use betweek H. curtus and H. schistosus 4.1 Number of tissue samples analysed 4.2 Summary statistics on Carbon and Nitrogen stable isotopes 4.3 Difference in niche width between sea snakes 4.4 Visualising posterior ellipses to compare species isotopic niche 4.5 Relative overlap in bayesian standard ellipses 4.6 References", " 4 Difference in resouce use betweek H. curtus and H. schistosus Carbon and Nitrogen isotope ratios were compared across snake species. Plasma and scale samples were used to compare short term and long term resource use respectively. Multiples metrics including niche width (SEA), variance (range), overlap (%) were used. This section needs to be revised with new data from CEaS # importing stable isotope data sia = read.csv(&quot;./Data/Stable Isotope Data_CEAS_241119.csv&quot;) # joining SI data to snake data sia_snakes = sia%&gt;% filter(Tissue.type != &quot;Gut Content&quot;)%&gt;% # removing prey SI data left_join(snakes, &#39;Field.Code&#39;)%&gt;% mutate(Lab = &quot;CEAS&quot;)%&gt;% # renamving variables for ease of understanding dplyr::rename(Delta.Carbon = d13C..vpdb. , Delta.Nitrogen = d15N..N2.air.)%&gt;% # selecting relevant variables dplyr::select(Date, Field.Code, Species, Snout.to.Vent..cm., Sex, Gravid, Class, Gear.Type, Fishing.Location, Depth.Caught..m., Plasma.Color, Delta.Carbon, Delta.Nitrogen, Lab, Tissue.type, Month, Year) # creating labels for figures D.C = expression({delta}^13*C~&#39;\\u2030&#39;) D.N = expression({delta}^15*N~&#39;\\u2030&#39;) 4.1 Number of tissue samples analysed sia_snakes%&gt;% filter(Tissue.type == &quot;Plasma&quot; | Tissue.type == &quot;Scales&quot;)%&gt;% filter(Species == &quot;Hydrophis curtus&quot; | Species == &quot;Hydrophis schistosus&quot;)%&gt;% group_by(Species, Tissue.type)%&gt;% count()%&gt;% spread(Tissue.type, n) Species Plasma Scales Hydrophis curtus 6 12 Hydrophis schistosus 27 25 4.2 Summary statistics on Carbon and Nitrogen stable isotopes Mean ± standard deviation (parts per mil) sia_snakes%&gt;% filter(Tissue.type == &quot;Plasma&quot; | Tissue.type == &quot;Scales&quot;)%&gt;% filter(Species == &quot;Hydrophis curtus&quot; | Species == &quot;Hydrophis schistosus&quot;)%&gt;% gather(c(&quot;Delta.Carbon&quot;, &quot;Delta.Nitrogen&quot;), key = &quot;Isotope&quot;, value = &quot;value&quot;)%&gt;% group_by(Species, Tissue.type, Isotope)%&gt;% summarise(Mean = round(mean(value, na.rm = T), 2), sd = round(sd(value, na.rm = T), 2), n = sum(!is.na(value)))%&gt;% unite(&quot;Mean.sd&quot;, Mean:sd, sep = &quot;±&quot;)%&gt;% dplyr::select(-n)%&gt;% spread(Isotope, Mean.sd)%&gt;% arrange(Tissue.type, Species) Species Tissue.type Delta.Carbon Delta.Nitrogen Hydrophis curtus Plasma -17.6±0.6 13.23±0.56 Hydrophis schistosus Plasma -16.72±1.14 14.45±1.12 Hydrophis curtus Scales -15.44±0.59 14.57±1.26 Hydrophis schistosus Scales -14.95±1.25 15.13±1.14 Both \\(\\delta^{15}N\\) and \\(\\delta^{13}C\\) were enriched in H. schistosus compared to H. curtus 4.3 Difference in niche width between sea snakes We used the SIBER package (Jackson et al. 2011) for to compare isotopic niche width and overlap between H. curtus and H. schistosus. # importing required libraries for stable isotope analysis library(SIBER) # Formating SI data for use with SIBER siber_snakes &lt;- sia_snakes%&gt;% dplyr::select(Delta.Carbon, Delta.Nitrogen, Tissue.type, Species)%&gt;% # selecting required variables # renaming varibale as per requirement for SIBER dplyr::rename(iso1 = Delta.Carbon, iso2 = Delta.Nitrogen, group = Tissue.type, community = Species)%&gt;% # removing missing data points filter(!is.na(group), !is.na(iso1), !is.na(iso2), community == &quot;Hydrophis schistosus&quot; | community == &quot;Hydrophis curtus&quot;)%&gt;% droplevels() # Creating a SIBER object for analysis siber.snakes = createSiberObject(siber_snakes) 4.3.1 Maximum likelihood estimate of SEA SEA.ML_snakes &lt;- groupMetricsML(siber.snakes) # Clean table data.frame(t(SEA.ML_snakes))%&gt;% rownames_to_column(&quot;Species.Tissue&quot;)%&gt;% separate(Species.Tissue, c(&quot;Species&quot;, &quot;Tissue&quot;), sep = &quot;([\\\\.\\\\?\\\\:])&quot;)%&gt;% arrange(Tissue, Species) Species Tissue TA SEA SEAc Hydrophis curtus Plasma 0.74470 0.6368364 0.8491152 Hydrophis schistosus Plasma 10.19485 3.1208774 3.2851342 Hydrophis curtus Scales 4.58370 2.4210563 2.7236883 Hydrophis schistosus Scales 20.43275 4.4823982 4.7065181 As maximum likelihood can only porivde point estimates of SEA, a bayesian model was used to provide more robust comparison of niche width. Add comparisoon of ML SEA here 4.3.2 Bayesian estimate of SEA We estimate the standard ellipse area (SEA) of each species in isotopic space by fitting a multivaria normal model to the isotope data using bayesian inference. # Setting options for running jags parms &lt;- list() # list of parameters fir JAGS parms$n.iter &lt;- 2*10^4 # number of iterations to run the model for parms$n.burnin &lt;- 1*10^3 # discard the first set of 1000 values parms$n.thin &lt;- 10 # thin the posterior by this many parms$n.chains &lt;- 2 # run this many chains # Defining vague priors priors &lt;- list() priors$R &lt;- 1 * diag(2) priors$k &lt;- 2 priors$tau.mu &lt;- 1.0E-3 # Fitting the model and getting posteriors snakes.post &lt;- siberMVN(siber.snakes, parms, priors) # estimating standard ellipse area from posteriors SEA.B_snakes &lt;- siberEllipses(snakes.post) # Creating a table of posterior estiamtes of Standard ellipse area ccc &lt;- names(snakes.post) colnames(SEA.B_snakes) &lt;- ccc SEA.B_snakesdf = data.frame(SEA.B_snakes, check.names = F)%&gt;% rowid_to_column(var = &quot;run&quot;)%&gt;% gather(Species.Tissue, SEA.B, -run)%&gt;% separate(Species.Tissue, c(&quot;Species&quot;,&quot;Tissue&quot;), sep = &quot;([\\\\.\\\\?\\\\:])&quot;) # Summarising Bayesian estimate of SEA SEA.B_snakesdf%&gt;% group_by(Species, Tissue)%&gt;% summarise(`Mean SEAb` = mean(SEA.B), `Standard deviation` = sd(SEA.B))%&gt;% arrange(Tissue, Species) Species Tissue Mean SEAb Standard deviation Hydrophis curtus Plasma 1.112015 0.6319474 Hydrophis schistosus Plasma 2.707978 0.9681427 Hydrophis curtus Scales 4.720363 1.0563752 Hydrophis schistosus Scales 3.302240 0.7538158 Add comparisoon of Bayesian SEA here 4.3.3 Testing difference in species niche area by tissue type SEA.B_snakesdf%&gt;% spread(key = Species, value = SEA.B)%&gt;% group_by(Tissue)%&gt;% summarise(`P(HS &gt; HC)` = sum(`Hydrophis schistosus` &gt; `Hydrophis curtus`)/n()) Tissue P(HS &gt; HC) Plasma 0.9450 Scales 0.1265 Hypothesis: H. schistosus SEA is larger than H. curtus While niche width is slightly larger in H. schistosus, it is not significantly different. The posterior distribution of SEA^b has right skewed long tail (masked by the limits of the graph for visual clarity) possibly due to the low sample size. Niche width doesn’t seem to change accross different tissue types either, indicating stability over variying periods of assimilation. Update inference 4.4 Visualising posterior ellipses to compare species isotopic niche # how many of the posterior draws do you want? n.posts &lt;- 10 # decide how big an ellipse you want to draw p.ell &lt;- pchisq(1,2) set.seed(1) # a list to store the results snake_ellipses &lt;- list() # loop over groups ## generating list with length groups*communities for (i in 1:length(snakes.post)) { # a dummy variable to build in the loop ell &lt;- NULL post.id &lt;- NULL # randomly extracting parameters for n samples from posterior distribution for ( j in sample(1:4000, n.posts)){ # covariance matrix Sigma &lt;- matrix(snakes.post[[i]][j,1:4], 2, 2) # mean mu &lt;- snakes.post[[i]][j,5:6] # ellipse points out &lt;- ellipse::ellipse(Sigma, centre = mu , level = p.ell) ell &lt;- rbind(ell, out) #ellipse points from current loop post.id &lt;- c(post.id, rep(j, nrow(out))) #adding loop number (rep) } ell &lt;- as.data.frame(ell) # data frame of ellipse points from all draws ell$rep &lt;- post.id # adding draw id snake_ellipses[[i]] &lt;- ell # creading list of draws from each community.group } snake.ellipses &lt;- bind_rows(snake_ellipses, .id = &quot;id&quot;) # creating a data frame of post ellipse draws # now we need the group and community names # extract them from the ellipses.posterior list group_comm_names &lt;- names(snakes.post)[as.numeric(snake.ellipses$id)] # extractin community.group from posteriors # split them and conver to a matrix, NB byrow = T split_group_comm &lt;- matrix(unlist(strsplit(group_comm_names, &quot;[.]&quot;)), nrow(snake.ellipses), 2, byrow = TRUE) # splitting communit and group snake.ellipses$community &lt;- split_group_comm[,1] snake.ellipses$group &lt;- split_group_comm[,2] snake.ellipses &lt;- dplyr::rename(snake.ellipses, iso1 = x, iso2 = y, Species = community, Tissue = group) # Plotting 10 randomly sampled ellipses siber_snakes%&gt;% rename(Species = community, Tissue = group)%&gt;% ggplot(aes(iso1, iso2, col = Species))+ geom_point(aes(shape = Species), size = 2)+ ylab(expression(paste(delta^{15}, &quot;N (\\u2030)&quot;)))+ xlab(expression(paste(delta^{13}, &quot;C (\\u2030)&quot;)))+ geom_polygon(data = snake.ellipses, mapping = aes(iso1, iso2, group = rep, linetype = Species, col = Species), fill = NA)+ scale_color_grey()+ facet_wrap(~Tissue)+ theme(legend.text = element_text(face = &quot;italic&quot;)) ggsave(last_plot(), filename = &quot;./Figures and Tables/figure3.tiff&quot;, height = 6, width = 8) Figure 3: Bayesian ellipses in isotopic space describing difference in niche width and resource use between H. curtus and H. schistosus. As seen in the SEA estimation, low sample size for H. curtus causes greater uncertainty in the estimation of standar ellipses even with bayesian inference. Both carbon and nitrogen isotpes seem to be enriched in scales when compared to plasma. Degree of overlap appears to be low for both tissues. Samples sizes for H. curtus in both tissues need to be increased despite using bayesian methods Unusual outlier in H. schistosus scales data needs to be checked Update inference 4.5 Relative overlap in bayesian standard ellipses # Overlap in ellipse based on plasma samples snake.p.overlap &lt;- bayesianOverlap(ellipse1 = &quot;Hydrophis schistosus.Plasma&quot; , #Group 1 ellipse2 = &quot;Hydrophis curtus.Plasma&quot;, #Group 2 snakes.post, #list with posteriour dists draws = 100, p.interval = 0.95, n = 100) #params snake.p.overlap &lt;- snake.p.overlap%&gt;% mutate(Turnover = &quot;Short-term&quot;) # plasma represents short - term turnover in isotope ratios # Overlap in ellipse based on scale samples snake.s.overlap &lt;- bayesianOverlap(ellipse1 = &quot;Hydrophis schistosus.Scales&quot; , #Group 1 ellipse2 = &quot;Hydrophis curtus.Scales&quot;, #Group 2 snakes.post, #list with posteriour dists draws = 100, p.interval = 0.95, n = 100) #params snake.s.overlap &lt;- snake.s.overlap%&gt;% mutate(Turnover = &quot;Long-term&quot;) # scales represent long term turn over in isotope ratios # Creating a combined data frame snake.overlap &lt;- bind_rows(snake.p.overlap, snake.s.overlap) # Plotting overlap snake.overlap%&gt;% mutate(prop.overlap = overlap/(area1 + area2 - overlap))%&gt;% #relative overlap ggplot(aes(prop.overlap))+ geom_histogram(bins = 10, col = &quot;black&quot;)+ #geom_vline(aes(xintercept = mean(prop.overlap), col = &quot;red&quot;), size = 1)+ labs(x = &quot;Proportion of overlap&quot;, y = &quot;Number of samples&quot;)+ scale_color_discrete(name = &quot;Mean&quot;)+ facet_wrap(~Turnover) # summarising overlap in standard ellipses snake.overlap%&gt;% group_by(Turnover)%&gt;% # calculating relative overlap in bayesian standard ellipses mutate(prop.overlap = overlap/(area1 + area2 - overlap))%&gt;% summarise(`Average overlap` = mean(prop.overlap), `Standard deviation` = sd(prop.overlap)) Turnover Average overlap Standard deviation Long-term 0.4306671 0.0725277 Short-term 0.0962143 0.0706418 Overlap between H. curtus and H. schistosus seems to be high in when comparing long term resource use, i.e., scales. However, overlap between H. curtus and H. schistosus seems to be very low when comparing short term resource use, i.e., plasma. This difference could be caused by: low sample size for H. curtus differences in processing of scales and plasma, i.e., lipid extraction Update inference 4.6 References Section 4.3.2 was adapeted from Andrew Jackson’s Github example. Section 4.4 was adapted from the SIBER Vignette. Section 4.5 was adapted from this Vignette. "],
["varition-in-fishing-intensity-along-the-sindhudurg-coast.html", "5 Varition in fishing intensity along the sindhudurg coast 5.1 Calculating effort with depth 5.2 Geocoding fishing trips 5.3 No. of trips sampled 5.4 Summarising fishing effort per trip 5.5 Testing difference in effort by gears 5.6 Mapping fishing intensity 5.7 Spatial coverage of trawlers and gillnets along the Sindhudurg coast", " 5 Varition in fishing intensity along the sindhudurg coast # importing effort data effort = read.csv(&quot;./Data/Fishing-Effort_250720.csv&quot;)%&gt;% group_by(Date, Gear.Type)%&gt;% distinct(Boat.name, .keep_all = T)%&gt;% # fixing repetitions in effort data mutate(Month = factor(months(dmy(Date)), levels = month.name), Year = year(dmy(Date)))%&gt;% filter(Gear.Type == &quot;Trawler&quot; | Gear.Type == &quot;GillNet&quot;) # removing beach seines and purse seines 5.1 Calculating effort with depth Fishing intensity: Vessel effort (Number of days fishing x No. of hauls x Average time per haul) is calculated for each boat on each day. This is then totaled for the sampling duration at each site. Should fishing intensity be analysed seperately by fishing gear. Should calculation of fishing intensity factor in Gears. dep_int = effort%&gt;% filter(Fishing.Location != &quot;&quot;)%&gt;% #removing missing location data dplyr::select(Date, Gear.Type, Fishing.Location, Boat.name, No..of.Hauls, Average.Haul.Time..Hours., No..of.Days.fishing, Depth..wav.)%&gt;% group_by(Gear.Type)%&gt;% # interpolating missing data with medians mutate(n.days = ifelse(is.na(No..of.Days.fishing), median(No..of.Days.fishing, na.rm = T), No..of.Days.fishing), n.hauls = ifelse(is.na(No..of.Hauls), median(No..of.Hauls, na.rm = T), No..of.Hauls), haul.time = ifelse(is.na(Average.Haul.Time..Hours.), median(Average.Haul.Time..Hours., na.rm = T), Average.Haul.Time..Hours.))%&gt;% ungroup()%&gt;% # calculating fihsing effort per trip mutate(effort = (n.days)*(n.hauls)*(haul.time), Depth.m = Depth..wav.*1.87)%&gt;% # converting depth to meters dplyr::select(Date, Boat.name, Gear.Type, Fishing.Location, Depth.m, effort)%&gt;% # selecting relevant variables drop_na() # remving missing values 5.2 Geocoding fishing trips Using data gathered from fisher surveys, we mapped the location of each fishing trip. The protocol for geocoding fishing trips is as follows: Nearest landmarks are geocoded from google maps API Latitude is extracted from landmark geocode Match landmark latitude and depth from survey to GEBCO data Extract final longitude from GEBCO data The protocol is encoded in Function/geocode.R source(&quot;./Functions/geocode.R&quot;) dep_int &lt;- geocode.trips(dep_int, fl = &#39;Fishing.Location&#39;, dep = &#39;Depth.m&#39;) # removing duplicates introduced by fuzzy joining dep_int &lt;- distinct(dep_int, Date, Boat.name, Fishing.Location, Gear.Type, Depth.m, .keep_all = T) # savinf output write.csv(dep_int, &quot;./Data/Fishing intensity_dep.csv&quot;) Note: fuzzyjoin::fuzzy_inner_join() introduces many duplicates, I have not as yet been able to fix the issue dirrectly. Currently, removing duplicates from output using dplyr::distinct(). 5.3 No. of trips sampled ## Sample size knitr::kable(table(dep_int$Gear.Type)) Var1 Freq GillNet 176 Trawler 104 5.4 Summarising fishing effort per trip # effort per boat dep_int%&gt;% group_by(Gear.Type)%&gt;% skimr::skim(effort)%&gt;% skimr::yank(&quot;numeric&quot;)%&gt;% dplyr::select(-hist) Variable type: numeric skim_variable Gear.Type n_missing complete_rate mean sd p0 p25 p50 p75 p100 effort GillNet 0 1 1.10 0.66 0.17 0.69 1 1 3.5 effort Trawler 0 1 17.66 8.09 4.00 12.00 18 18 48.0 5.5 Testing difference in effort by gears # T - test broom::tidy(t.test(effort ~ Gear.Type, data = dep_int))%&gt;% dplyr::select(estimate:p.value)%&gt;% # Effect size mutate(d = lsr::cohensD(effort ~ Gear.Type, data = dep_int))%&gt;% dplyr::select(-estimate)%&gt;% rename(`Gill net` = estimate1, Trawler = estimate2) Gill net Trawler statistic p.value d 1.104034 17.65625 -20.82884 0 3.343206 Trawlers had much higher fishing efforts than gillnets off the coast of Sindhudurg from 2018 - 2019. 5.6 Mapping fishing intensity # required libraries library(sp) library(rgdal) library(raster) library(ggmap) # Sampling grid as raster ext &lt;- raster(&quot;./Data/sampling_extent.tif&quot;) # importing functions for standardising effort source(&quot;./Functions/intensity extract.R&quot;) source(&quot;./Functions/raster to df.R&quot;) # Calculating fishing intensity in each grid cell fi &lt;- dep_int%&gt;% group_by(Gear.Type)%&gt;% nest()%&gt;% mutate(m = map(data, ~map.extract(df = ., var = &quot;effort&quot;, func = &#39;sum&#39;)), mdf = map(m, map.df))%&gt;% dplyr::select(mdf)%&gt;% unnest()%&gt;% spread(Gear.Type, layer) # Plotting intensity of fishing by gear type base &lt;- get_googlemap(center = c(mean(dep_int$lon),mean(dep_int$lat)), zoom = 9, scale = 4, maptype = &quot;terrain&quot;)##Getting basemap ## importing bathymetric data downloaded from GEBCO database library(marmap) depth &lt;- readGEBCO.bathy(&quot;./Data/gebco_2020_n16.7_s15.5_w72.0_e73.9.nc&quot;) ## converting depth data to usable data frame depth = fortify.bathy(depth)%&gt;% dplyr::rename(lon = x, lat = y, depth = z)%&gt;% filter(depth &lt; 1) ## loading funtion for plotting fishing intensity source(&quot;./Functions/intensity_plot.R&quot;) ## creating plot boat_plot &lt;- dep_int%&gt;% group_by(Gear.Type)%&gt;% nest()%&gt;% mutate(m = map(data, ~map.extract(df = ., var = &quot;effort&quot;, func = &#39;sum&#39;)), mdf = map(m, map.df), plot = map2(mdf, Gear.Type, ~int.plot(mdf = ., Gear.Type, name = &quot;Fishing intensity&quot;)))%&gt;% gridExtra::grid.arrange(grobs = .$plot, ncol = 2) ## saving high res figure for publication ggsave(boat_plot, filename = &quot;./Figures and Tables/figure4.tiff&quot;, width = 8, height = 4.5, dpi = 300) Figure 4: Distribution of fishing intensity of trawlers in gillnets operating from Malvan, Maharashtra. Black lines indicate 10m depth contours Each fishing trip is assigned to a cell in the sampling grid of 702 cells with 27 rows and 26 columns. Total fishing effort in each grid cell is then calculated to quatify local fishing intensity. Are points accurately depicted? Survey based map of fishing intensity may need to be verified with onboard observations and/or remote GPS data. Our field work for the same was cut short given the Coronavirus pandemic in 2020. Link to prelimary results for fisheries mapping 5.7 Spatial coverage of trawlers and gillnets along the Sindhudurg coast dep_int%&gt;% group_by(Gear.Type)%&gt;% nest()%&gt;% ## Caluclating total effort in each grid cell mutate(m = map(data, ~map.extract(df = ., var = &quot;effort&quot;, func = &#39;sum&#39;)), ## Converting raster to data frame mdf = map(m, map.df))%&gt;% dplyr::select(mdf)%&gt;% ## Caluclating spatial extent of fisheries as number of raster cells * 10 sq. km. summarise(`Extent (sq. km.)` = map(mdf, ~sum(.$layer&gt;0)*10))%&gt;% unnest() Gear.Type Extent (sq. km.) GillNet 550 Trawler 1180 As expexted, trawlers have a larger spatial foot print than gillnets. "],
["does-fishing-intensity-affect-the-distribution-of-h-curtus-and-h-schistosus.html", "6 Does fishing intensity affect the distribution of H. curtus and H. schistosus? 6.1 Spatial overlap between fisheries and sea snakes", " 6 Does fishing intensity affect the distribution of H. curtus and H. schistosus? # loading required libraries library(sp) library(raster) # importing data dep_int &lt;- read.csv(&quot;./Data/Fishing intensity_dep.csv&quot;) # geocoded fishing effort snakes_den &lt;- read.csv(&quot;./Data/snakes-density.csv&quot;) # sea snake occurence in bycatch ext &lt;- raster::raster(&quot;./Data/sampling_extent.tif&quot;) # sampling grid # importing required scripts source(&quot;./Functions/intensity extract.R&quot;) source(&quot;./Functions/raster to df.R&quot;) # Calculating fishing intensity fi &lt;- dep_int%&gt;% group_by(Gear.Type)%&gt;% nest()%&gt;% mutate(m = map(data, ~map.extract(df = ., var = &quot;effort&quot;, func = &#39;sum&#39;)), mdf = map(m, map.df))%&gt;% dplyr::select(mdf)%&gt;% unnest()%&gt;% spread(Gear.Type, layer) # Calculating sea snake CPUE den &lt;- snakes_den%&gt;% group_by(Species)%&gt;% nest()%&gt;% mutate(m = map(data, ~map.extract(df = ., var = &quot;n&quot;, func = &#39;sum&#39;)), mdf = map(m, map.df))%&gt;% dplyr::select(mdf)%&gt;% unnest()%&gt;% spread(Species, layer) # Calculating mean depth in cell library(marmap) depth &lt;- readGEBCO.bathy(&quot;./Data/gebco_2020_n16.7_s15.5_w72.0_e73.9.nc&quot;) depth = fortify.bathy(depth)%&gt;% # converting to usable data frame dplyr::rename(lon = x, lat = y, depth = z)%&gt;% filter(depth &lt; 1) dep &lt;- depth%&gt;% nest()%&gt;% mutate(m = map(data, ~map.extract(df = ., var = &quot;depth&quot;, func = mean)), mdf = map(m, map.df))%&gt;% dplyr::select(mdf)%&gt;% unnest()%&gt;% rename(mean.depth = layer) # Joining creating combined data frame fi_den&lt;- inner_join(fi, den, by = c(&quot;x&quot;, &quot;y&quot;))%&gt;% inner_join(dep, by = c(&quot;x&quot;, &quot;y&quot;))%&gt;% # calculating relative abaundance of sea snakes in each grid cell mutate(rel.prop = HC/(HC+HS)) # saving fi_den for analysis write.csv(fi, &quot;./Data/Fishing intensity_grid.csv&quot;, row.names = F) 6.1 Spatial overlap between fisheries and sea snakes # Calculating spatial overlap between sea snakes and fisheries sp.ovlp &lt;- fi_den%&gt;% gather(c(&quot;HS&quot;, &quot;HC&quot;), key = Species, value = CPUE)%&gt;% gather(c(&quot;GillNet&quot;, &quot;Trawler&quot;), key = Gear, value = intensity)%&gt;% group_by(Gear, Species)%&gt;% summarise(overlap = sum(CPUE &gt; 0 &amp; intensity &gt; 0, na.rm = T), extent.sp = sum(CPUE&gt;0), rel.ovlp = overlap/extent.sp) # Creating pretty table sp.ovlp%&gt;% dplyr::select(-extent.sp)%&gt;% mutate(rel.ovlp = 100*rel.ovlp, Species = ifelse(Species == &quot;HC&quot;, &quot;Hydrophis curtus&quot;, &quot;Hydrophis schistosus&quot;))%&gt;% rename(`Relative Overlap %` = rel.ovlp, `Spatial Overlap` = overlap) Gear Species Spatial Overlap Relative Overlap % GillNet Hydrophis curtus 38 70.37037 GillNet Hydrophis schistosus 44 72.13115 Trawler Hydrophis curtus 52 96.29630 Trawler Hydrophis schistosus 47 77.04918 6.1.1 Testing spatial overlap between sea snakes and fisheries We tested the spatial overlap between sea snakes and fisheries along the Sindhudurg coast as the difference in relative proportion of overlap among species and gear. sp.ovlp%&gt;% mutate(Species = ifelse(Species == &quot;HC&quot;, &quot;Hydrophis curtus&quot;, &quot;Hydrophis schistosus&quot;))%&gt;% group_by(Species)%&gt;% nest()%&gt;% mutate(ptest = map(data, ~prop.test(.$overlap, .$extent.sp)), # Z - test of proportion sumry = map(ptest, broom::tidy), h = map(sumry, ~pwr::ES.h(.$estimate2, .$estimate1)))%&gt;% # effect size dplyr::select(sumry, h)%&gt;% unnest()%&gt;% dplyr::select(Species:p.value, h)%&gt;% rename(`Gill Net` = estimate1, Trawler = estimate2) Species Gill Net Trawler statistic p.value h Hydrophis curtus 0.7037037 0.9629630 11.2666667 0.0007891 0.7638663 Hydrophis schistosus 0.7213115 0.7704918 0.1729883 0.6774696 0.1130845 Trawlers had significantly higher spatial overlap with both species. H. curtus overlaped more with trawlers than H. schistosus and vice - a - versa for H. shcistosus in gill nets. "],
["overlap-between-fisheries-catch-and-sea-snake-diet.html", "7 Overlap between fisheries catch and sea snake diet 7.1 Sampling Adequacy for fisherie catch data 7.2 Difference in catch landed per trip by gear 7.3 Richness of fish families found in fisheries catch 7.4 No. of Sea snake prey families found in fish catch and overlap 7.5 Relative proportion of sea snake prey in fisheries catch 7.6 Is the proportion of H. curtus prey greater than that of H. schistosus in catch? 7.7 Do trawlers have a greater trophic overlap with sea snakes than gillnets? 7.8 Sea snake prey species in fisheries catch", " 7 Overlap between fisheries catch and sea snake diet # importing catch data catch &lt;- read.csv(&quot;./Data/catch.csv&quot;) # importing gut content data gutcontent &lt;- read.csv(&quot;./Data/Sea_snakes_gut_content_2018-19.csv&quot;) # Standarising sea snake gut content data gutcontent = gutcontent%&gt;% # removing specimens collected from fish landing centers filter(Snake.Species == &quot;Hydrophis schistosus&quot; | Snake.Species == &quot;Hydrophis curtus&quot;, # removing unidentified specimens Prey.Family != &quot;Unidentified&quot;, Prey.Family != &quot;&quot;)%&gt;% group_by(Snake.Species)%&gt;% # caluclating abundance mutate(n = n())%&gt;% group_by(Snake.Species, Prey.Family)%&gt;% # calculating relative abunance from each snakes species summarise(Abundance = n(), n = last(n), Rel.prop = last(Abundance/n)) Note: Catch data was combined from multiple sources (Sharma et al. unpublished data and Gupta et al. unpublished data). The same was standardised for this analysis. Kindly refer to Functions/clean catch data.R for further details. 7.1 Sampling Adequacy for fisherie catch data # calculating number trips and fishing effort catch%&gt;% group_by(Gear.Type, Sample)%&gt;% # Number hauls and haul duration for each trip summarise(Haul.time = last(Haul.time), No.hauls = last(No.hauls))%&gt;% group_by(Gear.Type)%&gt;% # Number trips and effort sampled by gear type summarise(N = length(unique(Sample)), Haul.Hours = sum(No.hauls*Haul.time, na.rm = T)/60) Gear.Type N Haul.Hours Gill Net 38 35.41667 Trawler 140 434.65000 7.2 Difference in catch landed per trip by gear # importing catch weight data tonnage &lt;- read.csv(&quot;./Data/catch tonnage.csv&quot;) ## Summary tonnage%&gt;% group_by(Gear.Type)%&gt;% skimr::skim(Total.Catch..kg.)%&gt;% skimr::yank(&quot;numeric&quot;) Variable type: numeric skim_variable Gear.Type n_missing complete_rate mean sd p0 p25 p50 p75 p100 hist Total.Catch..kg. Gill Net 0 1 155.60 154.34 5 50.00 119.0 210.00 840.0 ▇▂▁▁▁ Total.Catch..kg. Trawler 0 1 330.81 308.61 29 134.52 211.5 387.38 1187.5 ▇▃▁▁▁ # Testing assumption of normality broom::tidy(shapiro.test(log(tonnage$Total.Catch..kg.))) statistic p.value method 0.966559 0.0203415 Shapiro-Wilk normality test # Test broom::tidy(t.test(log(Total.Catch..kg.) ~ Gear.Type, data = tonnage))%&gt;% mutate(d = lsr::cohensD(log(Total.Catch..kg.) ~ Gear.Type, data = tonnage))%&gt;%# effect size dplyr::select(estimate1:p.value, d)%&gt;% # inverse log mutate(estimate1 = exp(estimate1), estimate2 = exp(estimate2))%&gt;% rename(`Gill net` = estimate1, Trawler = estimate2) Gill net Trawler statistic p.value d 98.09173 226.0161 -3.896286 0.0002104 0.8447173 Trawlers landed significantly higher catches per trip than gill nets. Note: Total catch landed per trip in kgs was log transformed for normality. 7.3 Richness of fish families found in fisheries catch #Richness catch%&gt;% filter(Family != &quot;&quot;)%&gt;% group_by(Gear.Type)%&gt;% summarise(Family.Richness = length(unique(Family))) Gear.Type Family.Richness Gill Net 15 Trawler 48 7.4 No. of Sea snake prey families found in fish catch and overlap # Creating separate prey data frame for each species gc.hs &lt;- filter(gutcontent, Snake.Species == &quot;Hydrophis schistosus&quot;) gc.hc &lt;- filter(gutcontent, Snake.Species == &quot;Hydrophis curtus&quot;) # Creating data martix for fisheries catch catch_fam &lt;- catch%&gt;% # removing unidentified speciemens filter(Family != &quot;&quot;)%&gt;% group_by(Gear.Type, Sample)%&gt;% # Calculating total weight per sample mutate(Sample.Wt = sum(Weight.g, na.rm = T))%&gt;% group_by(Gear.Type, Sample, Family)%&gt;% # Weight of each fish family in catch summarise(Biomass = sum(Weight.g, na.rm = T), # Marking sea snake prey families Prey = last(ifelse(Family%in%gutcontent$Prey.Family, &quot;Yes&quot;, &quot;No&quot;)), Sample.Wt = last(Sample.Wt))%&gt;% # Caluclating relative proportion in catch mutate(Rel.biomass = Biomass/Sample.Wt)#%&gt;% ## Adding sea snake species catch_fam = catch_fam%&gt;% mutate(HS = if_else(Family%in%gc.hs$Prey.Family, &quot;Yes&quot;, &quot;No&quot;), HC= if_else(Family%in%gc.hc$Prey.Family, &quot;Yes&quot;, &quot;No&quot;)) # number of prey families caught by each gear catch_fam%&gt;% gather(c(&quot;HC&quot;, &quot;HS&quot;), key = &quot;Snake species&quot;, value = &quot;Prey&quot;)%&gt;% filter(Prey == &quot;Yes&quot;)%&gt;% group_by(Gear.Type, `Snake species`)%&gt;% summarise(`Prey Family Overlap` = length(unique(Family)))%&gt;% mutate(`Snake species` = ifelse(`Snake species` == &quot;HC&quot;, &quot;Hydrophis curtus&quot;, &quot;Hydrophis schistosus&quot;)) Gear.Type Snake species Prey Family Overlap Gill Net Hydrophis curtus 7 Gill Net Hydrophis schistosus 7 Trawler Hydrophis curtus 9 Trawler Hydrophis schistosus 10 Trawlers caught more sea snake prey families than gillnets. 7.5 Relative proportion of sea snake prey in fisheries catch # prey of each species as relative proportion in fisheries catch catch_fam%&gt;% gather(c(&quot;HC&quot;, &quot;HS&quot;), key = snake, value = Prey)%&gt;% filter(Prey == &quot;Yes&quot;)%&gt;% group_by(Gear.Type, Sample, snake)%&gt;% summarise(N = length(unique(Family)), Biomass = sum(Biomass), Sample.Wt = last(Sample.Wt), rel.prop = Biomass/Sample.Wt)%&gt;% group_by(Gear.Type, snake)%&gt;% summarise(Mean.prop = mean(rel.prop)) Gear.Type snake Mean.prop Gill Net HC 0.8204191 Gill Net HS 0.8188879 Trawler HC 0.7356892 Trawler HS 0.4842906 Sea snake prey consisted of a greater proportion of gillnet catch than trawler catch on average. 7.6 Is the proportion of H. curtus prey greater than that of H. schistosus in catch? catch_fam%&gt;% gather(c(&quot;HC&quot;, &quot;HS&quot;), key = snake, value = Prey)%&gt;% filter(Prey == &quot;Yes&quot;)%&gt;% group_by(Gear.Type, Sample, snake)%&gt;% summarise(Biomass = sum(Biomass), Sample.Wt = last(Sample.Wt), rel.prop = Biomass/Sample.Wt)%&gt;% group_by(Gear.Type)%&gt;% nest()%&gt;% mutate(ttest = map(data, ~t.test(rel.prop ~ snake, data = .)), sumry = map(ttest, broom::tidy), d = map(data, ~lsr::cohensD(rel.prop ~ snake, data = .)))%&gt;% dplyr::select(sumry, d)%&gt;% unnest()%&gt;% dplyr::select(Gear.Type:p.value, d, -estimate)%&gt;% rename(`H. curtus` = estimate1, `H. schistosus` = estimate2) Gear.Type H. curtus H. schistosus statistic p.value d Gill Net 0.8204191 0.8188879 0.0412568 0.9672023 0.0094650 Trawler 0.7356892 0.4842906 7.0245510 0.0000000 0.8885814 Yes, for trawlers. 7.7 Do trawlers have a greater trophic overlap with sea snakes than gillnets? catch_fam%&gt;% gather(c(&quot;HC&quot;, &quot;HS&quot;), key = snake, value = Prey)%&gt;% filter(Prey == &quot;Yes&quot;)%&gt;% group_by(Gear.Type, Sample, snake)%&gt;% summarise(Biomass = sum(Biomass), Sample.Wt = last(Sample.Wt), rel.prop = Biomass/Sample.Wt)%&gt;% group_by(snake)%&gt;% nest()%&gt;% mutate(ttest = map(data, ~t.test(rel.prop ~ Gear.Type, data = .)), sumry = map(ttest, broom::tidy), d = map(data, ~lsr::cohensD(rel.prop ~ Gear.Type, data = .)))%&gt;% dplyr::select(sumry, d)%&gt;% unnest()%&gt;% dplyr::select(snake:p.value, d, -estimate)%&gt;% rename(`Gill net` = estimate1, Trawler = estimate2) snake Gill net Trawler statistic p.value d HC 0.8204191 0.7356892 2.469163 0.0153629 0.3588295 HS 0.8188879 0.4842906 8.695296 0.0000000 1.1771718 Yes. 7.8 Sea snake prey species in fisheries catch Species constituting &gt;10% of the catch on average are represented. catch_fam%&gt;% gather(c(&quot;HC&quot;, &quot;HS&quot;), key = &quot;snake&quot;, value = &quot;Prey&quot;)%&gt;% filter(Prey == &quot;Yes&quot;)%&gt;% group_by(Gear.Type, Family)%&gt;% summarise(N = length(unique(Family)), p = mean(Rel.biomass, na.rm = T))%&gt;% ggplot(aes(reorder(Family, p), p))+ geom_col(width = 0.5)+ scale_fill_brewer(palette = &quot;Greys&quot;)+ labs(x = &quot;Fish Family&quot;, y = &quot;Average proportion in catch&quot;)+ scale_y_sqrt()+ theme(axis.text.x = element_text(angle = 60, hjust = 1, face = &quot;italic&quot;))+ facet_wrap(~Gear.Type, ncol = 1) ggsave(last_plot(), filename = &quot;./Figures and Tables/figure5.png&quot;, height = 8, width = 8) "],
["does-isotopic-niche-of-sea-snakes-change-with-local-fishing-intensity.html", "8 Does isotopic niche of sea snakes change with local fishing intensity? 8.1 Determining cluster of fishing intensity off the coast of sindhudurg 8.2 Determining capture grid cell for individual snakes 8.3 Sample size 8.4 Variation isotope ratio with fishing intensity 8.5 Modeling isotope ratios with fishing intensity 8.6 Difference in niche width between sea snakes", " 8 Does isotopic niche of sea snakes change with local fishing intensity? It is infeasible to to find sites with little to no fishing pressure on mainland India. Hence, it is nigh impossible to conduct a study with controls and test sites with varying levels of fishing pressure. How do you test the niche shift hypotheses with out spatial replicates? While the control - test study design failed, fishing effort data was collected from multiple vessels (Gillnet and Trawlers) landing at the Malvan harbour over the period of 1.5 years along side diet, abundance (snakes and prey), and isotopic data. So we ask the following questions: Is there a corellation between fishing intensity and isotopic ratios? Do niche metrics (width, overlap) vary with fishing pressure (high, medium and low preiods during the year)? What temporal resolution should be used for the analysis? Day, week, month or season. Which is appropriate and why? Depending on the tissue being analysed. Scales - month, Plasma - week We used only plasma SI samples for this analysis as they reflect the isotopic assimilation in the short - term where effects of fisheries are expected. 8.1 Determining cluster of fishing intensity off the coast of sindhudurg We used hierarchical clustering based on fishing intensity of both gears, and the position of the cell in the grid to divided the grid into high and low fishing intensity zones. # loading required libraries library(sp) library(raster) # importing data dep_int &lt;- read.csv(&quot;./Data/Fishing intensity_dep.csv&quot;) # geocoded fishing effort snakes_den &lt;- read.csv(&quot;./Data/snakes-density.csv&quot;) # sea snake occurence in bycatch ext &lt;- raster::raster(&quot;./Data/sampling_extent.tif&quot;) # sampling grid # importing required scripts source(&quot;./Functions/intensity extract.R&quot;) source(&quot;./Functions/raster to df.R&quot;) # Calculating fishing intensity fi &lt;- dep_int%&gt;% group_by(Gear.Type)%&gt;% nest()%&gt;% mutate(m = map(data, ~map.extract(df = ., var = &quot;effort&quot;, func = &#39;sum&#39;)), mdf = map(m, map.df))%&gt;% dplyr::select(mdf)%&gt;% unnest()%&gt;% spread(Gear.Type, layer) ## creating distance matrix dist_fi &lt;- dist(fi) ## Hierarchical clustering clust_fi &lt;- hclust(dist_fi) ## Assigning fishing intensity classes fi_class &lt;- cutree(clust_fi, 6) ## cutting the tree 4 times ## Naming clasess fi &lt;- fi%&gt;% # extracting classes from clustering mutate(class = as.factor(ifelse(fi_class %in% seq(4, 6, 1) , &quot;High&quot;, ifelse(fi_class == 2 | fi_class == 3, &quot;Medium&quot;, &quot;Low&quot;) ) ) )%&gt;% # reordering classes mutate(class = fct_relevel(class, c(&quot;High&quot;, &quot;Medium&quot;, &quot;Low&quot;))) ## Plotting grid ggplot(fi, aes(x, y, fill = class))+ geom_tile(col = &quot;black&quot;)+ scale_fill_brewer(palette = &quot;Set1&quot;, name = &quot;Fishing intensity&quot;)+ labs(x = &quot;Longitude&quot;, y = &quot;Latitude&quot;)+ theme(text = element_text(size = 10)) Clustering may need to be revised based on sample size 8.2 Determining capture grid cell for individual snakes Using data gathered from fisher surveys, we mapped the location of each fishing trip. The protocol for geocoding fishing trips is as follows: Nearest landmarks are geocoded from google maps API Latitude is extracted from landmark geocode Match landmark latitude and depth from survey to GEBCO data Extract final longitude from GEBCO data The protocol is encoded in Function/geocode.R # importing stable isotope data sia = read.csv(&quot;./Data/Stable Isotope Data_CEAS_241119.csv&quot;) # joining sia data to snake data sia_snakes = sia%&gt;% filter(Tissue.type != &quot;Gut Content&quot;)%&gt;% left_join(snakes, &#39;Field.Code&#39;)%&gt;% mutate(Lab = &quot;CEAS&quot;)%&gt;% rename(Delta.Carbon = d13C..vpdb. , Delta.Nitrogen = d15N..N2.air.)%&gt;% dplyr::select(Date, Field.Code, Species, Snout.to.Vent..cm., Sex, Gravid, Class, Gear.Type, Fishing.Location, Location.encountered, Depth.Caught..m., Plasma.Color, Delta.Carbon, Delta.Nitrogen, Lab, Tissue.type, Month, Year)%&gt;% # using location encountered where fishing location is unavailable mutate(Fishing.Location = ifelse(Fishing.Location == &quot;&quot;, Location.encountered, Fishing.Location))%&gt;% mutate(Fishing.Location = ifelse(Fishing.Location == &quot;Dandi&quot; | Fishing.Location == &quot;Dandi Beach&quot;, &quot;Wayari&quot;, Fishing.Location)) #selecting relavant variables sia_li = sia_snakes%&gt;% dplyr::select(Field.Code, Species, Fishing.Location, Depth.Caught..m.,Tissue.type, Delta.Carbon, Delta.Nitrogen)%&gt;% filter(Fishing.Location != &quot;&quot;)%&gt;% drop_na()%&gt;% droplevels() ## Geocoding si data source(&quot;./Functions/geocode.R&quot;) sia_li &lt;- geocode.trips(sia_li, fl = &#39;Fishing.Location&#39;, dep = &#39;Depth.Caught..m.&#39;) ## removing duplicates introduced by fuzzy joining sia_li &lt;- distinct(sia_li, Field.Code, Tissue.type, .keep_all = T) ## Assigning grid cells to snakes source(&quot;./Functions/find cell.R&quot;) # importing cell.ext function ext &lt;- raster::raster(&quot;./Data/sampling_extent.tif&quot;) # sampling grid sia_fi &lt;- sia_li%&gt;% group_by(Field.Code, Species, Tissue.type, Delta.Carbon, Delta.Nitrogen)%&gt;% nest()%&gt;% mutate(cell = map(data, cell.ext), celldf = map(cell, as.data.frame))%&gt;% dplyr::select(celldf)%&gt;% unnest()%&gt;% ungroup() ## Saving data to save time write.csv(sia_li, &quot;./Data/SIA_fishing intensity.csv&quot;) Note: fuzzyjoin::fuzzy_inner_join() introduces many duplicates, I have not as yet been able to fix the issue dirrectly. Currently, removing duplicates from output using dplyr::distinct(). 8.3 Sample size # adding fishing intensity class sia_li &lt;- sia_fi%&gt;% left_join(fi, c(&quot;x&quot;,&quot;y&quot;))%&gt;% mutate(intensity = GillNet + Trawler) # summarising number of samples table(sia_li$Species, sia_li$Tissue.type, sia_li$class)%&gt;% as.data.frame()%&gt;% spread(Var3, Freq)%&gt;% rename(Species = Var1, Tissue = Var2)%&gt;% arrange(Species, Tissue) Species Tissue High Medium Low Hydrophis curtus Plasma 3 0 0 Hydrophis curtus Scales 3 0 5 Hydrophis schistosus Plasma 14 0 5 Hydrophis schistosus Scales 10 2 9 8.4 Variation isotope ratio with fishing intensity # plotting sia_li%&gt;% gather(key = Isotope, c(Delta.Carbon, Delta.Nitrogen), value = ratio)%&gt;% ggplot(aes(intensity, ratio, col = Species))+ geom_point(size = 3)+ geom_smooth(method = lm)+ scale_color_brewer(palette = &quot;Set1&quot;)+ labs(x = &quot;Fishing intensity&quot;, y = &quot;Isotope ratio&quot;)+ theme(legend.text = element_text(face = &quot;italic&quot;))+ facet_grid(Isotope ~ Tissue.type, scale = &quot;free_y&quot;) Both \\(\\delta^{15}N\\) and \\(\\delta^{13}C\\) show strong negatice relationship with increasing fishing intensity. Update with new SI data 8.5 Modeling isotope ratios with fishing intensity sia_li%&gt;% gather(key = Isotope, c(Delta.Carbon, Delta.Nitrogen), value = ratio)%&gt;% group_by(Species, Isotope, Tissue.type)%&gt;% nest()%&gt;% mutate( mod1 = map(data, ~lm(ratio ~ intensity, data = .)), summ1 = map(mod1, broom::tidy), r2 = map(mod1, broom::glance) )%&gt;% dplyr::select(summ1, r2)%&gt;% unnest()%&gt;% dplyr::select(Species:p.value, adj.r.squared)%&gt;% arrange(adj.r.squared) Species Tissue.type Isotope term estimate std.error statistic p.value adj.r.squared Hydrophis curtus Plasma Delta.Nitrogen (Intercept) 12.8982083 2.4227476 5.3237937 0.1182028 -0.9915169 Hydrophis curtus Plasma Delta.Nitrogen intensity 0.0017107 0.0262109 0.0652657 0.9585094 -0.9915169 Hydrophis curtus Plasma Delta.Carbon (Intercept) -18.6725417 2.5912866 -7.2058961 0.0877864 -0.6913990 Hydrophis curtus Plasma Delta.Carbon intensity 0.0119747 0.0280343 0.4271453 0.7430053 -0.6913990 Hydrophis curtus Scales Delta.Carbon (Intercept) -15.5223733 0.4015798 -38.6532680 0.0000000 -0.1593582 Hydrophis curtus Scales Delta.Carbon intensity 0.0006768 0.0034798 0.1944817 0.8522166 -0.1593582 Hydrophis schistosus Plasma Delta.Nitrogen (Intercept) 14.6123093 0.5519175 26.4755302 0.0000000 -0.0563590 Hydrophis schistosus Plasma Delta.Nitrogen intensity -0.0015819 0.0079433 -0.1991515 0.8445068 -0.0563590 Hydrophis schistosus Plasma Delta.Carbon (Intercept) -16.1469039 0.5657921 -28.5385825 0.0000000 -0.0192282 Hydrophis schistosus Plasma Delta.Carbon intensity -0.0066175 0.0081430 -0.8126639 0.4276454 -0.0192282 Hydrophis schistosus Scales Delta.Carbon (Intercept) -14.4914512 0.5548915 -26.1158269 0.0000000 -0.0040982 Hydrophis schistosus Scales Delta.Carbon intensity -0.0088601 0.0092455 -0.9583170 0.3499396 -0.0040982 Hydrophis schistosus Scales Delta.Nitrogen (Intercept) 15.9172692 0.4687112 33.9596538 0.0000000 0.1180202 Hydrophis schistosus Scales Delta.Nitrogen intensity -0.0149738 0.0078096 -1.9173563 0.0703531 0.1180202 Hydrophis curtus Scales Delta.Nitrogen (Intercept) 14.8744630 0.2892050 51.4322520 0.0000000 0.4836411 Hydrophis curtus Scales Delta.Nitrogen intensity -0.0068888 0.0025060 -2.7489020 0.0333402 0.4836411 Samples sizes for H. curtus are low, however, fishing intensity seems to have a significant depletion effect on plasma isotope ratios in H. schistosus. 8.6 Difference in niche width between sea snakes See section 4 for more details on analysis with SIBER. # Loading required libraries library(SIBER) #Creating siber data ## Plasma samples siber_pl_fi = sia_li%&gt;% filter(Tissue.type == &quot;Plasma&quot;)%&gt;% # using plasma values for comparison dplyr::select(Delta.Carbon, Delta.Nitrogen, Species, class)%&gt;% # renaming baed on SIBER conventions rename(iso1 = Delta.Carbon, iso2 = Delta.Nitrogen, group = class, # setting fishing intesnity as group community = Species)%&gt;% # removing missing data filter(!is.na(group), !is.na(iso1), !is.na(iso2), community == &quot;Hydrophis schistosus&quot; | community == &quot;Hydrophis curtus&quot;)%&gt;% ungroup()%&gt;% dplyr::select(iso1, iso2, group, community)%&gt;% droplevels() # Creating SIBER object fo MVN fitting siber.plasma.fi = createSiberObject(as.data.frame(siber_pl_fi)) ## Scale samples siber_sc_fi = sia_li%&gt;% filter(Tissue.type == &quot;Scales&quot;)%&gt;% # using plasma values for comparison dplyr::select(Delta.Carbon, Delta.Nitrogen, Species, class)%&gt;% # renaming baed on SIBER conventions rename(iso1 = Delta.Carbon, iso2 = Delta.Nitrogen, group = class, # setting fishing intesnity as group community = Species)%&gt;% # removing missing data filter(!is.na(group), !is.na(iso1), !is.na(iso2), community == &quot;Hydrophis schistosus&quot; | community == &quot;Hydrophis curtus&quot;)%&gt;% ungroup()%&gt;% dplyr::select(iso1, iso2, group, community)%&gt;% droplevels() # Creating SIBER object fo MVN fitting siber.scales.fi = createSiberObject(as.data.frame(siber_sc_fi)) 8.6.1 Maximum likelihood estimate of SEA SEA.ML_plasma.fi &lt;- groupMetricsML(siber.plasma.fi)# for plamsa samples SEA.ML_scales.fi &lt;- groupMetricsML(siber.scales.fi)# for scale samples data.frame(t(SEA.ML_plasma.fi))%&gt;% rownames_to_column(&quot;Species.FI&quot;)%&gt;% mutate(Tissue = &quot;Plasma&quot;)%&gt;% full_join( (data.frame(t(SEA.ML_scales.fi))%&gt;% rownames_to_column(&quot;Species.FI&quot;)%&gt;% mutate(Tissue = &quot;Scales&quot;) ) )%&gt;% group_by(Tissue)%&gt;% arrange(Species.FI) Species.FI TA SEA SEAc Tissue Hydrophis curtus.High 0.22165 0.4020286 0.8040573 Plasma Hydrophis curtus.High 1.37520 2.4943369 4.9886738 Scales Hydrophis curtus.Low 0.76530 0.7141832 0.9522443 Scales Hydrophis schistosus.High 7.67850 3.1365745 3.3979557 Plasma Hydrophis schistosus.High 13.73420 5.9066433 6.6449737 Scales Hydrophis schistosus.Low 3.69500 4.1063132 5.4750843 Plasma Hydrophis schistosus.Low 1.78710 0.9545990 1.0909702 Scales Hydrophis schistosus.Medium 0.00000 0.0000000 Scales As maximum likelihood can only porivde point estimates of SEA, a bayesian model was used to provide more robust comparison of niche width. 8.6.2 Bayesian estimate of SEA # options for running jags parms &lt;- list() parms$n.iter &lt;- 2 * 10^4 # number of iterations to run the model for parms$n.burnin &lt;- 1 * 10^3 # discard the first set of values parms$n.thin &lt;- 10 # thin the posterior by this many parms$n.chains &lt;- 2 # run this many chains # define the priors priors &lt;- list() priors$R &lt;- 1 * diag(2) priors$k &lt;- 2 priors$tau.mu &lt;- 1.0E-3 # scale samples scales.fi.post &lt;- siberMVN(siber.scales.fi, parms, priors)#fitting multivariate normal model and getting posteriors SEA.B_scales.fi &lt;- siberEllipses(scales.fi.post)#estimating standard ellipse area from posteriors means.B_scales.fi &lt;- extractPosteriorMeans(siber.scales.fi, scales.fi.post)#mean isotope values ccc &lt;- names(scales.fi.post) colnames(SEA.B_scales.fi) &lt;- ccc # plasma samples plasma.fi.post &lt;- siberMVN(siber.plasma.fi, parms, priors)#fitting multivariate normal model and getting posteriors SEA.B_plasma.fi &lt;- siberEllipses(plasma.fi.post)#estimating standard ellipse area from posteriors means.B_plasma.fi &lt;- extractPosteriorMeans(siber.plasma.fi, plasma.fi.post)#mean isotope values ccc &lt;- names(plasma.fi.post) colnames(SEA.B_plasma.fi) &lt;- ccc # creating data frame SEA.B_snakes.fi.df = data.frame(SEA.B_plasma.fi, check.names = F)%&gt;% rowid_to_column(var = &quot;run&quot;)%&gt;% gather(Species.class, SEA.B, -run)%&gt;% separate(Species.class, c(&quot;Species&quot;,&quot;FI.Class&quot;), sep = &quot;([\\\\.\\\\?\\\\:])&quot;)%&gt;% mutate(Tissue = &quot;Plasma&quot;)%&gt;% # appending scale runs full_join( data.frame(SEA.B_scales.fi, check.names = F)%&gt;% rowid_to_column(var = &quot;run&quot;)%&gt;% gather(Species.class, SEA.B, -run)%&gt;% separate(Species.class, c(&quot;Species&quot;,&quot;FI.Class&quot;), sep = &quot;([\\\\.\\\\?\\\\:])&quot;)%&gt;% mutate(Tissue = &quot;Scale&quot;) ) #Summarising SEA estimates SEA.B_snakes.fi.df%&gt;% group_by(Species, Tissue, FI.Class)%&gt;% summarise(SEA.mean = mean(SEA.B), SEA.sd = sd(SEA.B), SEA.se = sd(SEA.B)/sqrt(n())) Species Tissue FI.Class SEA.mean SEA.sd SEA.se Hydrophis curtus Plasma High 1.448797 1.4940365 0.0236228 Hydrophis curtus Scale High 1.141236 0.6650210 0.0105149 Hydrophis curtus Scale Low 1.103833 0.4209654 0.0066560 Hydrophis schistosus Plasma High 3.393052 0.9728041 0.0153814 Hydrophis schistosus Plasma Low 5.581869 3.1191320 0.0493178 Hydrophis schistosus Scale High 6.588881 2.3118165 0.0365530 Hydrophis schistosus Scale Low 3.845325 3.6389185 0.0575364 Hydrophis schistosus Scale Medium 4.608901 7.1724467 0.1134063 8.6.3 Testing difference in species niche area by fishing intensity SEA.B_snakes.fi.df%&gt;% spread(key = FI.Class, value = SEA.B)%&gt;% group_by(Species, Tissue)%&gt;% summarise(`P(High &gt; Low)` = sum(`High` &gt; `Low`)/n()) Species Tissue P(High &gt; Low) Hydrophis curtus Plasma Hydrophis curtus Scale 0.47475 Hydrophis schistosus Plasma 0.23050 Hydrophis schistosus Scale 0.84950 #Currently no medium cells #`P(Medium &gt; Low)` = sum(`Medium` &gt; `Low`)/n(), #`P(High &gt; Medium)` = sum(`High` &gt; `Medium`)/n()) 8.6.4 Visualising difference in niche width across gradiet of fishing intensity SEA.B_snakes.fi.df%&gt;% # reordering classes mutate(FI.Class = fct_relevel(FI.Class, c(&quot;High&quot;, &quot;Medium&quot;, &quot;Low&quot;)))%&gt;% ggplot(aes(Species, SEA.B, fill = FI.Class))+ geom_boxplot(alpha = 0.3, width = 0.25, position = position_dodge(preserve = &quot;single&quot;))+ scale_y_continuous(limits = c(0,5), name = &quot;Standard Ellispes Area&quot;, guide = guide_axis(n.dodge = 1))+ scale_fill_discrete(name = &quot;Fishing Intensity&quot;)+ theme(axis.text.x = element_text(face = &quot;italic&quot;))+ facet_grid(~Tissue) ggsave(last_plot(), filename = &quot;./Figures and Tables/figure6.png&quot;, height = 6, width = 10, device = &quot;png&quot;) Currently many outliers from 5 - 15 on y - axis "]
]
